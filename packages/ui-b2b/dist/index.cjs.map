{"version":3,"sources":["../src/index.ts","../src/primitives/DataTable/useDataTable.ts","../src/primitives/BulkSelector/useBulkSelector.ts","../src/primitives/ApprovalFlow/useApprovalFlow.ts","../src/primitives/SpendingMeter/useSpendingMeter.ts","../src/primitives/SpendingMeter/types.ts","../src/primitives/QuoteBuilder/useQuoteBuilder.ts","../src/forms/employee.schema.ts","../src/forms/quote.schema.ts","../src/forms/company.schema.ts","../src/forms/spending-limit.schema.ts","../src/utils/approval-rules.ts","../src/utils/spending-calculator.ts","../src/utils/csv-parser.ts","../src/utils/format.ts"],"sourcesContent":["/**\n * @maison/ui-b2b\n *\n * Headless B2B UI components for Maison e-commerce.\n *\n * This package provides logic-only primitives, form schemas,\n * and utilities for building B2B commerce interfaces.\n *\n * @example\n * ```tsx\n * // Import primitives\n * import { useDataTable, useBulkSelector } from '@maison/ui-b2b';\n *\n * // Import form schemas\n * import { employeeCreateSchema } from '@maison/ui-b2b/forms';\n *\n * // Import utilities\n * import { formatCurrency, evaluateRules } from '@maison/ui-b2b/utils';\n * ```\n */\n\n// =============================================================================\n// PRIMITIVES\n// =============================================================================\n\n// DataTable\nexport { useDataTable } from \"./primitives/DataTable\";\nexport type {\n  ColumnDef,\n  DataTableState,\n  FilterConfig,\n  FilterOperator,\n  PaginationConfig,\n  PaginationState,\n  RowSelectionMode,\n  RowSelectionState,\n  SortConfig,\n  SortDirection,\n  UseDataTableOptions,\n  UseDataTableReturn,\n} from \"./primitives/DataTable\";\n\n// BulkSelector\nexport { useBulkSelector } from \"./primitives/BulkSelector\";\nexport type {\n  BulkSelectionState,\n  SelectableItem,\n  SelectionState,\n  UseBulkSelectorOptions,\n  UseBulkSelectorReturn,\n} from \"./primitives/BulkSelector\";\n\n// ApprovalFlow\nexport { useApprovalFlow } from \"./primitives/ApprovalFlow\";\nexport type {\n  ApprovalAction,\n  ApprovalFlowState,\n  ApprovalStep,\n  ApprovalStepStatus,\n  ApprovalWorkflow,\n  ApprovalWorkflowStatus,\n  Approver,\n  UseApprovalFlowOptions,\n  UseApprovalFlowReturn,\n} from \"./primitives/ApprovalFlow\";\n\n// SpendingMeter\nexport {\n  useSpendingMeter,\n  DEFAULT_CURRENCY,\n  DEFAULT_THRESHOLDS,\n} from \"./primitives/SpendingMeter\";\nexport type {\n  CurrencyConfig,\n  SpendingLimit,\n  SpendingMeterState,\n  SpendingPeriod,\n  SpendingThreshold,\n  ThresholdLevel,\n  UseSpendingMeterOptions,\n  UseSpendingMeterReturn,\n} from \"./primitives/SpendingMeter\";\n\n// QuoteBuilder\nexport { useQuoteBuilder } from \"./primitives/QuoteBuilder\";\nexport type {\n  Address,\n  CartItem,\n  DiscountType,\n  Quote,\n  QuoteBuilderState,\n  QuoteCustomer,\n  QuoteDiscount,\n  QuoteLineItem,\n  QuotePricing,\n  QuoteStatus,\n  QuoteTerms,\n  QuoteValidationError,\n  TaxType,\n  UseQuoteBuilderOptions,\n  UseQuoteBuilderReturn,\n} from \"./primitives/QuoteBuilder\";\n\n// =============================================================================\n// FORMS (Zod Schemas)\n// =============================================================================\n\n// Employee schemas\nexport {\n  employeeBaseSchema,\n  employeeBulkImportRowSchema,\n  employeeCreateSchema,\n  employeeFilterSchema,\n  employeeInviteSchema,\n  employeePermissionsSchema,\n  employeeRoleSchema,\n  employeeSpendingLimitSchema,\n  employeeStatusSchema,\n  employeeUpdateSchema,\n} from \"./forms/employee.schema\";\nexport type {\n  EmployeeBulkImportRow,\n  EmployeeCreateInput,\n  EmployeeFilter,\n  EmployeeInviteInput,\n  EmployeePermissions,\n  EmployeeRole,\n  EmployeeSpendingLimit,\n  EmployeeStatus,\n  EmployeeUpdateInput,\n} from \"./forms/employee.schema\";\n\n// Quote schemas\nexport {\n  addressSchema,\n  discountTypeSchema,\n  lineItemDiscountSchema,\n  quoteCreateSchema,\n  quoteCustomerSchema,\n  quoteDiscountSchema,\n  quoteFilterSchema,\n  quoteLineItemSchema,\n  quotePricingSchema,\n  quoteResponseSchema,\n  quoteSendSchema,\n  quoteStatusSchema,\n  quoteTermsSchema,\n  quoteUpdateSchema,\n  taxTypeSchema,\n} from \"./forms/quote.schema\";\nexport type {\n  AddressInput,\n  LineItemDiscountInput,\n  QuoteCreateInput,\n  QuoteCustomerInput,\n  QuoteDiscountInput,\n  QuoteFilter,\n  QuoteLineItemInput,\n  QuotePricingInput,\n  QuoteResponseInput,\n  QuoteSendInput,\n  QuoteTermsInput,\n  QuoteUpdateInput,\n} from \"./forms/quote.schema\";\n\n// Company schemas\nexport {\n  companyAddressSchema,\n  companyBillingSettingsSchema,\n  companyBrandingSettingsSchema,\n  companyFilterSchema,\n  companyNotificationSettingsSchema,\n  companyOrderingSettingsSchema,\n  companyProfileSchema,\n  companyRegistrationSchema,\n  companySettingsSchema,\n  companyShippingSettingsSchema,\n  companyStatusSchema,\n  companyTypeSchema,\n} from \"./forms/company.schema\";\nexport type {\n  CompanyAddressInput,\n  CompanyBillingSettingsInput,\n  CompanyBrandingSettingsInput,\n  CompanyFilter,\n  CompanyNotificationSettingsInput,\n  CompanyOrderingSettingsInput,\n  CompanyProfileInput,\n  CompanyRegistrationInput,\n  CompanySettingsInput,\n  CompanyShippingSettingsInput,\n  CompanyStatus,\n  CompanyType,\n} from \"./forms/company.schema\";\n\n// Spending limit schemas\nexport {\n  categorySpendingLimitCreateSchema,\n  companySpendingLimitCreateSchema,\n  costCenterSpendingLimitCreateSchema,\n  currencyConfigSchema,\n  departmentSpendingLimitCreateSchema,\n  employeeSpendingLimitCreateSchema,\n  spendingAdjustmentSchema,\n  spendingLimitBaseSchema,\n  spendingLimitCreateSchema,\n  spendingLimitFilterSchema,\n  spendingLimitStatusSchema,\n  spendingLimitTypeSchema,\n  spendingLimitUpdateSchema,\n  spendingPeriodSchema,\n  spendingThresholdSchema,\n  spendingTransactionSchema,\n  thresholdActionSchema,\n} from \"./forms/spending-limit.schema\";\nexport type {\n  CategorySpendingLimitCreateInput,\n  CompanySpendingLimitCreateInput,\n  CostCenterSpendingLimitCreateInput,\n  CurrencyConfigInput,\n  DepartmentSpendingLimitCreateInput,\n  EmployeeSpendingLimitCreateInput,\n  SpendingAdjustmentInput,\n  SpendingLimitCreateInput,\n  SpendingLimitFilter,\n  SpendingLimitStatus,\n  SpendingLimitType,\n  SpendingLimitUpdateInput,\n  SpendingPeriod as SpendingLimitPeriod,\n  SpendingThresholdInput,\n  SpendingTransactionInput,\n  ThresholdAction,\n} from \"./forms/spending-limit.schema\";\n\n// =============================================================================\n// UTILITIES\n// =============================================================================\n\n// Approval Rules\nexport {\n  canAutoApprove,\n  createAmountRule,\n  createDepartmentRule,\n  createRoleRule,\n  DEFAULT_APPROVAL_RULES,\n  evaluateCondition,\n  evaluateRule,\n  evaluateRules,\n  getRequiredApprovers,\n  requiresApproval,\n  shouldReject,\n} from \"./utils/approval-rules\";\nexport type {\n  ApprovalRule,\n  RuleAction,\n  RuleActionType,\n  RuleCondition,\n  RuleConditionType,\n  RuleEvaluationContext,\n  RuleEvaluationResult,\n} from \"./utils/approval-rules\";\n\n// Spending Calculator\nexport {\n  calculateByCategory,\n  calculateByDay,\n  calculateEffectiveLimit,\n  calculateRollover,\n  calculateSavingsOpportunity,\n  calculateSpending,\n  calculateTotal,\n  calculateTrend,\n  canMakePurchase,\n  daysBetween,\n  filterByPeriod,\n  generateForecast,\n  getPeriodDates,\n} from \"./utils/spending-calculator\";\nexport type {\n  SpendingCalculation,\n  SpendingLimitConfig,\n  SpendingPeriodType,\n  SpendingRecord,\n} from \"./utils/spending-calculator\";\n\n// CSV Parser\nexport {\n  EMPLOYEE_COLUMN_MAPPINGS,\n  generateCsv,\n  generateTemplate,\n  mapColumns,\n  parseCsv,\n  readAndParseCsv,\n  readFileAsText,\n  validateFileSize,\n} from \"./utils/csv-parser\";\nexport type {\n  ColumnMapping,\n  CsvParseError,\n  CsvParseOptions,\n  CsvParseResult,\n} from \"./utils/csv-parser\";\n\n// Formatters\nexport {\n  formatAddress,\n  formatCompanyName,\n  formatCurrency,\n  formatCurrencyCompact,\n  formatDate,\n  formatDuration,\n  formatFileSize,\n  formatInvoiceNumber,\n  formatNumber,\n  formatOrderNumber,\n  formatPaymentTerms,\n  formatPercentage,\n  formatPhoneNumber,\n  formatQuantity,\n  formatQuoteNumber,\n  formatRelativeDate,\n  formatVatId,\n  truncateText,\n} from \"./utils/format\";\nexport type {\n  CurrencyFormatOptions,\n  DateFormatOptions,\n  NumberFormatOptions,\n} from \"./utils/format\";\n","import { useCallback, useMemo, useReducer } from \"react\";\nimport type {\n  ColumnDef,\n  DataTableState,\n  FilterConfig,\n  PaginationConfig,\n  PaginationState,\n  RowSelectionState,\n  SortConfig,\n  SortDirection,\n  UseDataTableOptions,\n  UseDataTableReturn,\n} from \"./types\";\n\n/**\n * Action types for the data table reducer\n */\ntype DataTableAction<TData> =\n  | { type: \"SET_SORT\"; payload: SortConfig<TData> | null }\n  | { type: \"SET_FILTER\"; payload: FilterConfig<TData> }\n  | { type: \"REMOVE_FILTER\"; payload: keyof TData | string }\n  | { type: \"CLEAR_FILTERS\" }\n  | { type: \"SET_FILTERS\"; payload: FilterConfig<TData>[] }\n  | { type: \"SET_PAGE\"; payload: number }\n  | { type: \"SET_PAGE_SIZE\"; payload: number }\n  | { type: \"SELECT_ROW\"; payload: string }\n  | { type: \"DESELECT_ROW\"; payload: string }\n  | { type: \"TOGGLE_ROW\"; payload: string }\n  | { type: \"SELECT_ALL\"; payload: string[] }\n  | { type: \"DESELECT_ALL\" }\n  | { type: \"SET_COLUMN_VISIBILITY\"; payload: { columnId: string; visible: boolean } }\n  | { type: \"SET_DATA\"; payload: TData[] }\n  | { type: \"RESET\"; payload: InternalState<TData> };\n\n/**\n * Internal state (without computed values)\n */\ninterface InternalState<TData> {\n  originalData: TData[];\n  columns: ColumnDef<TData>[];\n  sort: SortConfig<TData> | null;\n  filters: FilterConfig<TData>[];\n  pageIndex: number;\n  pageSize: number;\n  selectedRowIds: Set<string>;\n}\n\n/**\n * Create initial state\n */\nfunction createInitialState<TData>(\n  options: UseDataTableOptions<TData>\n): InternalState<TData> {\n  return {\n    originalData: options.data,\n    columns: options.columns.map((col) => ({\n      ...col,\n      visible: col.visible !== false,\n    })),\n    sort: options.initialSort ?? null,\n    filters: options.initialFilters ?? [],\n    pageIndex: 0,\n    pageSize: options.pageSize ?? 10,\n    selectedRowIds: new Set(options.initialSelection ?? []),\n  };\n}\n\n/**\n * Reducer for data table state\n */\nfunction dataTableReducer<TData>(\n  state: InternalState<TData>,\n  action: DataTableAction<TData>\n): InternalState<TData> {\n  switch (action.type) {\n    case \"SET_SORT\":\n      return { ...state, sort: action.payload, pageIndex: 0 };\n\n    case \"SET_FILTER\": {\n      const existingIndex = state.filters.findIndex(\n        (f) => f.key === action.payload.key\n      );\n      const newFilters =\n        existingIndex >= 0\n          ? state.filters.map((f, i) => (i === existingIndex ? action.payload : f))\n          : [...state.filters, action.payload];\n      return { ...state, filters: newFilters, pageIndex: 0 };\n    }\n\n    case \"REMOVE_FILTER\":\n      return {\n        ...state,\n        filters: state.filters.filter((f) => f.key !== action.payload),\n        pageIndex: 0,\n      };\n\n    case \"CLEAR_FILTERS\":\n      return { ...state, filters: [], pageIndex: 0 };\n\n    case \"SET_FILTERS\":\n      return { ...state, filters: action.payload, pageIndex: 0 };\n\n    case \"SET_PAGE\":\n      return { ...state, pageIndex: action.payload };\n\n    case \"SET_PAGE_SIZE\":\n      return { ...state, pageSize: action.payload, pageIndex: 0 };\n\n    case \"SELECT_ROW\": {\n      const newSelected = new Set(state.selectedRowIds);\n      newSelected.add(action.payload);\n      return { ...state, selectedRowIds: newSelected };\n    }\n\n    case \"DESELECT_ROW\": {\n      const newSelected = new Set(state.selectedRowIds);\n      newSelected.delete(action.payload);\n      return { ...state, selectedRowIds: newSelected };\n    }\n\n    case \"TOGGLE_ROW\": {\n      const newSelected = new Set(state.selectedRowIds);\n      if (newSelected.has(action.payload)) {\n        newSelected.delete(action.payload);\n      } else {\n        newSelected.add(action.payload);\n      }\n      return { ...state, selectedRowIds: newSelected };\n    }\n\n    case \"SELECT_ALL\":\n      return { ...state, selectedRowIds: new Set(action.payload) };\n\n    case \"DESELECT_ALL\":\n      return { ...state, selectedRowIds: new Set() };\n\n    case \"SET_COLUMN_VISIBILITY\":\n      return {\n        ...state,\n        columns: state.columns.map((col) =>\n          col.id === action.payload.columnId\n            ? { ...col, visible: action.payload.visible }\n            : col\n        ),\n      };\n\n    case \"SET_DATA\":\n      return { ...state, originalData: action.payload };\n\n    case \"RESET\":\n      return action.payload;\n\n    default:\n      return state;\n  }\n}\n\n/**\n * Get nested value from object using dot notation path\n */\nfunction getNestedValue<TData>(obj: TData, path: string): unknown {\n  return path.split(\".\").reduce<unknown>((current, key) => {\n    if (current && typeof current === \"object\" && key in current) {\n      return (current as Record<string, unknown>)[key];\n    }\n    return undefined;\n  }, obj);\n}\n\n/**\n * Default sort function\n */\nfunction defaultSortFn<TData>(\n  a: TData,\n  b: TData,\n  key: string,\n  direction: SortDirection\n): number {\n  if (direction === null) return 0;\n\n  const aVal = getNestedValue(a, key);\n  const bVal = getNestedValue(b, key);\n\n  // Handle null/undefined\n  if (aVal == null && bVal == null) return 0;\n  if (aVal == null) return direction === \"asc\" ? 1 : -1;\n  if (bVal == null) return direction === \"asc\" ? -1 : 1;\n\n  // Compare values\n  let comparison = 0;\n  if (typeof aVal === \"string\" && typeof bVal === \"string\") {\n    comparison = aVal.localeCompare(bVal);\n  } else if (typeof aVal === \"number\" && typeof bVal === \"number\") {\n    comparison = aVal - bVal;\n  } else if (aVal instanceof Date && bVal instanceof Date) {\n    comparison = aVal.getTime() - bVal.getTime();\n  } else {\n    comparison = String(aVal).localeCompare(String(bVal));\n  }\n\n  return direction === \"asc\" ? comparison : -comparison;\n}\n\n/**\n * Default filter function\n */\nfunction defaultFilterFn<TData>(row: TData, filter: FilterConfig<TData>): boolean {\n  const value = getNestedValue(row, filter.key as string);\n\n  switch (filter.operator) {\n    case \"equals\":\n      return value === filter.value;\n\n    case \"notEquals\":\n      return value !== filter.value;\n\n    case \"contains\":\n      return String(value).toLowerCase().includes(String(filter.value).toLowerCase());\n\n    case \"notContains\":\n      return !String(value).toLowerCase().includes(String(filter.value).toLowerCase());\n\n    case \"startsWith\":\n      return String(value).toLowerCase().startsWith(String(filter.value).toLowerCase());\n\n    case \"endsWith\":\n      return String(value).toLowerCase().endsWith(String(filter.value).toLowerCase());\n\n    case \"gt\":\n      return Number(value) > Number(filter.value);\n\n    case \"gte\":\n      return Number(value) >= Number(filter.value);\n\n    case \"lt\":\n      return Number(value) < Number(filter.value);\n\n    case \"lte\":\n      return Number(value) <= Number(filter.value);\n\n    case \"between\":\n      return (\n        Number(value) >= Number(filter.value) &&\n        Number(value) <= Number(filter.valueTo)\n      );\n\n    case \"in\":\n      return Array.isArray(filter.value) && filter.value.includes(value);\n\n    case \"notIn\":\n      return Array.isArray(filter.value) && !filter.value.includes(value);\n\n    case \"isEmpty\":\n      return value == null || value === \"\";\n\n    case \"isNotEmpty\":\n      return value != null && value !== \"\";\n\n    default:\n      return true;\n  }\n}\n\n/**\n * Hook for headless data table state management\n *\n * Provides sorting, filtering, pagination, and row selection\n * functionality without any UI rendering.\n *\n * @example\n * ```tsx\n * const table = useDataTable({\n *   data: products,\n *   columns: [\n *     { id: 'name', accessorKey: 'name', header: 'Name', sortable: true },\n *     { id: 'price', accessorKey: 'price', header: 'Price', sortable: true },\n *   ],\n *   getRowId: (row) => row.id,\n *   pageSize: 20,\n *   selectionMode: 'multiple',\n * });\n *\n * // Use table.state.data for current page data\n * // Use table.toggleSort('name') to sort by name\n * // Use table.nextPage() to go to next page\n * ```\n */\nexport function useDataTable<TData>(\n  options: UseDataTableOptions<TData>\n): UseDataTableReturn<TData> {\n  const {\n    data,\n    columns,\n    getRowId,\n    pageSize = 10,\n    selectionMode = \"none\",\n    enableClientSideSort = true,\n    enableClientSideFilter = true,\n    enableClientSidePagination = true,\n    serverSideTotalCount,\n    onSortChange,\n    onFiltersChange,\n    onPaginationChange,\n    onSelectionChange,\n  } = options;\n\n  const initialState = useMemo(\n    () => createInitialState(options),\n    // Only recreate on column changes, not data changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [columns]\n  );\n\n  const [state, dispatch] = useReducer(dataTableReducer<TData>, initialState);\n\n  // Update data when it changes externally\n  useMemo(() => {\n    if (data !== state.originalData) {\n      dispatch({ type: \"SET_DATA\", payload: data });\n    }\n  }, [data, state.originalData]);\n\n  // Process data (filter and sort)\n  const processedData = useMemo(() => {\n    let result = [...(data || [])];\n\n    // Apply filters (client-side)\n    if (enableClientSideFilter && state.filters.length > 0) {\n      result = result.filter((row) => {\n        return state.filters.every((filter) => {\n          const column = state.columns.find(\n            (c) => c.id === filter.key || c.accessorKey === filter.key\n          );\n          if (column?.filterFn) {\n            return column.filterFn(row, filter);\n          }\n          return defaultFilterFn(row, filter);\n        });\n      });\n    }\n\n    // Apply sort (client-side)\n    if (enableClientSideSort && state.sort && state.sort.direction) {\n      const column = state.columns.find(\n        (c) => c.id === state.sort!.key || c.accessorKey === state.sort!.key\n      );\n      const sortKey = (column?.accessorKey as string) || (state.sort.key as string);\n\n      result.sort((a, b) => {\n        if (column?.sortFn) {\n          return column.sortFn(a, b, state.sort!.direction);\n        }\n        return defaultSortFn(a, b, sortKey, state.sort!.direction);\n      });\n    }\n\n    return result;\n  }, [\n    data,\n    state.filters,\n    state.sort,\n    state.columns,\n    enableClientSideFilter,\n    enableClientSideSort,\n  ]);\n\n  // Calculate pagination\n  const paginationState: PaginationState = useMemo(() => {\n    const totalItems = serverSideTotalCount ?? processedData.length;\n    const totalPages = Math.max(1, Math.ceil(totalItems / state.pageSize));\n    const safePageIndex = Math.min(state.pageIndex, totalPages - 1);\n    const startIndex = safePageIndex * state.pageSize + 1;\n    const endIndex = Math.min(startIndex + state.pageSize - 1, totalItems);\n\n    return {\n      pageIndex: safePageIndex,\n      pageSize: state.pageSize,\n      totalItems,\n      totalPages,\n      hasPreviousPage: safePageIndex > 0,\n      hasNextPage: safePageIndex < totalPages - 1,\n      startIndex: totalItems > 0 ? startIndex : 0,\n      endIndex,\n    };\n  }, [processedData.length, state.pageIndex, state.pageSize, serverSideTotalCount]);\n\n  // Get paginated data\n  const paginatedData = useMemo(() => {\n    if (!enableClientSidePagination) {\n      return processedData;\n    }\n    const start = paginationState.pageIndex * paginationState.pageSize;\n    const end = start + paginationState.pageSize;\n    return processedData.slice(start, end);\n  }, [processedData, paginationState, enableClientSidePagination]);\n\n  // Calculate row selection state\n  const rowSelectionState: RowSelectionState = useMemo(() => {\n    const visibleRowIds = paginatedData.map(getRowId);\n    const selectedVisibleCount = visibleRowIds.filter((id) =>\n      state.selectedRowIds.has(id)\n    ).length;\n\n    return {\n      selectedRowIds: state.selectedRowIds,\n      allSelected: visibleRowIds.length > 0 && selectedVisibleCount === visibleRowIds.length,\n      someSelected: selectedVisibleCount > 0 && selectedVisibleCount < visibleRowIds.length,\n    };\n  }, [paginatedData, state.selectedRowIds, getRowId]);\n\n  // Build full state\n  const fullState: DataTableState<TData> = useMemo(\n    () => ({\n      data: paginatedData,\n      originalData: data,\n      columns: state.columns,\n      sort: state.sort,\n      filters: state.filters,\n      pagination: paginationState,\n      rowSelection: rowSelectionState,\n      isLoading: false,\n      error: null,\n    }),\n    [\n      paginatedData,\n      data,\n      state.columns,\n      state.sort,\n      state.filters,\n      paginationState,\n      rowSelectionState,\n    ]\n  );\n\n  // Sorting actions\n  const setSort = useCallback(\n    (sort: SortConfig<TData> | null) => {\n      dispatch({ type: \"SET_SORT\", payload: sort });\n      onSortChange?.(sort);\n    },\n    [onSortChange]\n  );\n\n  const toggleSort = useCallback(\n    (columnId: string) => {\n      const column = state.columns.find((c) => c.id === columnId);\n      if (!column?.sortable) return;\n\n      const key = (column.accessorKey as string) || columnId;\n      let newDirection: SortDirection = \"asc\";\n\n      if (state.sort?.key === key) {\n        if (state.sort.direction === \"asc\") {\n          newDirection = \"desc\";\n        } else if (state.sort.direction === \"desc\") {\n          newDirection = null;\n        }\n      }\n\n      const newSort = newDirection ? { key, direction: newDirection } : null;\n      dispatch({ type: \"SET_SORT\", payload: newSort });\n      onSortChange?.(newSort);\n    },\n    [state.columns, state.sort, onSortChange]\n  );\n\n  const clearSort = useCallback(() => {\n    dispatch({ type: \"SET_SORT\", payload: null });\n    onSortChange?.(null);\n  }, [onSortChange]);\n\n  // Filter actions\n  const setFilter = useCallback(\n    (filter: FilterConfig<TData>) => {\n      dispatch({ type: \"SET_FILTER\", payload: filter });\n      const newFilters = state.filters.some((f) => f.key === filter.key)\n        ? state.filters.map((f) => (f.key === filter.key ? filter : f))\n        : [...state.filters, filter];\n      onFiltersChange?.(newFilters);\n    },\n    [state.filters, onFiltersChange]\n  );\n\n  const removeFilter = useCallback(\n    (columnKey: keyof TData | string) => {\n      dispatch({ type: \"REMOVE_FILTER\", payload: columnKey });\n      onFiltersChange?.(state.filters.filter((f) => f.key !== columnKey));\n    },\n    [state.filters, onFiltersChange]\n  );\n\n  const clearFilters = useCallback(() => {\n    dispatch({ type: \"CLEAR_FILTERS\" });\n    onFiltersChange?.([]);\n  }, [onFiltersChange]);\n\n  const setFilters = useCallback(\n    (filters: FilterConfig<TData>[]) => {\n      dispatch({ type: \"SET_FILTERS\", payload: filters });\n      onFiltersChange?.(filters);\n    },\n    [onFiltersChange]\n  );\n\n  // Pagination actions\n  const goToPage = useCallback(\n    (pageIndex: number) => {\n      const safePage = Math.max(0, Math.min(pageIndex, paginationState.totalPages - 1));\n      dispatch({ type: \"SET_PAGE\", payload: safePage });\n      onPaginationChange?.({ pageIndex: safePage, pageSize: state.pageSize });\n    },\n    [paginationState.totalPages, state.pageSize, onPaginationChange]\n  );\n\n  const nextPage = useCallback(() => {\n    if (paginationState.hasNextPage) {\n      goToPage(paginationState.pageIndex + 1);\n    }\n  }, [paginationState, goToPage]);\n\n  const previousPage = useCallback(() => {\n    if (paginationState.hasPreviousPage) {\n      goToPage(paginationState.pageIndex - 1);\n    }\n  }, [paginationState, goToPage]);\n\n  const firstPage = useCallback(() => {\n    goToPage(0);\n  }, [goToPage]);\n\n  const lastPage = useCallback(() => {\n    goToPage(paginationState.totalPages - 1);\n  }, [paginationState.totalPages, goToPage]);\n\n  const setPageSize = useCallback(\n    (size: number) => {\n      dispatch({ type: \"SET_PAGE_SIZE\", payload: size });\n      onPaginationChange?.({ pageIndex: 0, pageSize: size });\n    },\n    [onPaginationChange]\n  );\n\n  // Row selection actions\n  const selectRow = useCallback(\n    (rowId: string) => {\n      if (selectionMode === \"none\") return;\n\n      if (selectionMode === \"single\") {\n        dispatch({ type: \"DESELECT_ALL\" });\n      }\n      dispatch({ type: \"SELECT_ROW\", payload: rowId });\n\n      const newSelected = new Set(state.selectedRowIds);\n      if (selectionMode === \"single\") {\n        newSelected.clear();\n      }\n      newSelected.add(rowId);\n      onSelectionChange?.(Array.from(newSelected));\n    },\n    [selectionMode, state.selectedRowIds, onSelectionChange]\n  );\n\n  const deselectRow = useCallback(\n    (rowId: string) => {\n      dispatch({ type: \"DESELECT_ROW\", payload: rowId });\n      const newSelected = new Set(state.selectedRowIds);\n      newSelected.delete(rowId);\n      onSelectionChange?.(Array.from(newSelected));\n    },\n    [state.selectedRowIds, onSelectionChange]\n  );\n\n  const toggleRowSelection = useCallback(\n    (rowId: string) => {\n      if (selectionMode === \"none\") return;\n\n      if (state.selectedRowIds.has(rowId)) {\n        deselectRow(rowId);\n      } else {\n        selectRow(rowId);\n      }\n    },\n    [selectionMode, state.selectedRowIds, selectRow, deselectRow]\n  );\n\n  const selectAll = useCallback(() => {\n    if (selectionMode !== \"multiple\") return;\n\n    const allIds = paginatedData.map(getRowId);\n    dispatch({ type: \"SELECT_ALL\", payload: allIds });\n    onSelectionChange?.(allIds);\n  }, [selectionMode, paginatedData, getRowId, onSelectionChange]);\n\n  const deselectAll = useCallback(() => {\n    dispatch({ type: \"DESELECT_ALL\" });\n    onSelectionChange?.([]);\n  }, [onSelectionChange]);\n\n  const toggleSelectAll = useCallback(() => {\n    if (rowSelectionState.allSelected) {\n      deselectAll();\n    } else {\n      selectAll();\n    }\n  }, [rowSelectionState.allSelected, selectAll, deselectAll]);\n\n  const isRowSelected = useCallback(\n    (rowId: string) => state.selectedRowIds.has(rowId),\n    [state.selectedRowIds]\n  );\n\n  const getSelectedRows = useCallback((): TData[] => {\n    return data.filter((row) => state.selectedRowIds.has(getRowId(row)));\n  }, [data, state.selectedRowIds, getRowId]);\n\n  // Column visibility\n  const toggleColumnVisibility = useCallback((columnId: string) => {\n    const column = state.columns.find((c) => c.id === columnId);\n    if (column) {\n      dispatch({\n        type: \"SET_COLUMN_VISIBILITY\",\n        payload: { columnId, visible: !column.visible },\n      });\n    }\n  }, [state.columns]);\n\n  const setColumnVisibility = useCallback((columnId: string, visible: boolean) => {\n    dispatch({ type: \"SET_COLUMN_VISIBILITY\", payload: { columnId, visible } });\n  }, []);\n\n  const getVisibleColumns = useCallback(\n    () => state.columns.filter((c) => c.visible !== false),\n    [state.columns]\n  );\n\n  // Data access\n  const getPaginatedData = useCallback(() => paginatedData, [paginatedData]);\n\n  const getProcessedData = useCallback(() => processedData, [processedData]);\n\n  const getCellValue = useCallback(\n    <TValue = unknown>(row: TData, columnId: string): TValue => {\n      const column = state.columns.find((c) => c.id === columnId);\n      if (!column) {\n        return undefined as TValue;\n      }\n\n      if (column.accessorFn) {\n        return column.accessorFn(row) as TValue;\n      }\n\n      if (column.accessorKey) {\n        return getNestedValue(row, column.accessorKey as string) as TValue;\n      }\n\n      return undefined as TValue;\n    },\n    [state.columns]\n  );\n\n  // Reset\n  const reset = useCallback(() => {\n    dispatch({ type: \"RESET\", payload: initialState });\n  }, [initialState]);\n\n  return {\n    state: fullState,\n\n    // Sorting\n    setSort,\n    toggleSort,\n    clearSort,\n\n    // Filtering\n    setFilter,\n    removeFilter,\n    clearFilters,\n    setFilters,\n\n    // Pagination\n    goToPage,\n    nextPage,\n    previousPage,\n    firstPage,\n    lastPage,\n    setPageSize,\n\n    // Row selection\n    selectRow,\n    deselectRow,\n    toggleRowSelection,\n    selectAll,\n    deselectAll,\n    toggleSelectAll,\n    isRowSelected,\n    getSelectedRows,\n\n    // Column visibility\n    toggleColumnVisibility,\n    setColumnVisibility,\n    getVisibleColumns,\n\n    // Data access\n    getPaginatedData,\n    getProcessedData,\n    getCellValue,\n\n    // Reset\n    reset,\n  };\n}\n","import { useCallback, useMemo, useState } from \"react\";\nimport type {\n  BulkSelectionState,\n  SelectableItem,\n  SelectionState,\n  UseBulkSelectorOptions,\n  UseBulkSelectorReturn,\n} from \"./types\";\n\n/**\n * Default function to get item ID\n */\nfunction defaultGetItemId<T extends SelectableItem>(item: T): string {\n  return item.id;\n}\n\n/**\n * Default function to check if item is selectable\n */\nfunction defaultIsItemSelectable(): boolean {\n  return true;\n}\n\n/**\n * Hook for bulk selection functionality\n *\n * Provides \"select all\", partial selection, and range selection\n * capabilities for lists of items.\n *\n * @example\n * ```tsx\n * const { state, toggle, toggleAll, isSelected } = useBulkSelector({\n *   items: employees,\n *   onSelectionChange: (ids, items) => {\n *     console.log(`Selected ${items.length} employees`);\n *   },\n * });\n *\n * // In your list:\n * {employees.map(emp => (\n *   <label key={emp.id}>\n *     <input\n *       type=\"checkbox\"\n *       checked={isSelected(emp.id)}\n *       onChange={() => toggle(emp.id)}\n *     />\n *     {emp.name}\n *   </label>\n * ))}\n *\n * // Select all checkbox:\n * <input\n *   type=\"checkbox\"\n *   checked={state.isAllSelected}\n *   ref={el => el && (el.indeterminate = state.isPartiallySelected)}\n *   onChange={toggleAll}\n * />\n * ```\n */\nexport function useBulkSelector<T extends SelectableItem>(\n  options: UseBulkSelectorOptions<T>\n): UseBulkSelectorReturn<T> {\n  const {\n    items,\n    initialSelectedIds = [],\n    getItemId = defaultGetItemId,\n    isItemSelectable = defaultIsItemSelectable,\n    maxSelection,\n    onSelectionChange,\n  } = options;\n\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(\n    () => new Set(initialSelectedIds)\n  );\n\n  // Get selectable items\n  const selectableItems = useMemo(\n    () => items.filter(isItemSelectable),\n    [items, isItemSelectable]\n  );\n\n  const selectableIds = useMemo(\n    () => new Set(selectableItems.map(getItemId)),\n    [selectableItems, getItemId]\n  );\n\n  // Calculate selection state\n  const state: BulkSelectionState = useMemo(() => {\n    // Only count selected IDs that are actually in the current selectable items\n    const validSelectedIds = new Set(\n      Array.from(selectedIds).filter((id) => selectableIds.has(id))\n    );\n    const selectedCount = validSelectedIds.size;\n    const totalCount = selectableItems.length;\n\n    let selectionState: SelectionState = \"none\";\n    if (selectedCount === 0) {\n      selectionState = \"none\";\n    } else if (selectedCount === totalCount && totalCount > 0) {\n      selectionState = \"all\";\n    } else {\n      selectionState = \"some\";\n    }\n\n    return {\n      selectedIds: validSelectedIds,\n      selectionState,\n      selectedCount,\n      totalCount,\n      isAllSelected: selectionState === \"all\",\n      isPartiallySelected: selectionState === \"some\",\n      isNoneSelected: selectionState === \"none\",\n    };\n  }, [selectedIds, selectableIds, selectableItems.length]);\n\n  // Notify selection change\n  const notifyChange = useCallback(\n    (newSelectedIds: Set<string>) => {\n      if (onSelectionChange) {\n        const ids = Array.from(newSelectedIds);\n        const selectedItems = items.filter((item) =>\n          newSelectedIds.has(getItemId(item))\n        );\n        onSelectionChange(ids, selectedItems);\n      }\n    },\n    [items, getItemId, onSelectionChange]\n  );\n\n  // Selection actions\n  const select = useCallback(\n    (id: string) => {\n      if (!selectableIds.has(id)) return;\n      if (maxSelection && selectedIds.size >= maxSelection && !selectedIds.has(id)) {\n        return;\n      }\n\n      setSelectedIds((prev) => {\n        if (prev.has(id)) return prev;\n        const newSet = new Set(prev);\n        newSet.add(id);\n        notifyChange(newSet);\n        return newSet;\n      });\n    },\n    [selectableIds, maxSelection, selectedIds.size, notifyChange]\n  );\n\n  const deselect = useCallback(\n    (id: string) => {\n      setSelectedIds((prev) => {\n        if (!prev.has(id)) return prev;\n        const newSet = new Set(prev);\n        newSet.delete(id);\n        notifyChange(newSet);\n        return newSet;\n      });\n    },\n    [notifyChange]\n  );\n\n  const toggle = useCallback(\n    (id: string) => {\n      if (!selectableIds.has(id)) return;\n\n      setSelectedIds((prev) => {\n        const newSet = new Set(prev);\n        if (newSet.has(id)) {\n          newSet.delete(id);\n        } else {\n          if (maxSelection && newSet.size >= maxSelection) {\n            return prev;\n          }\n          newSet.add(id);\n        }\n        notifyChange(newSet);\n        return newSet;\n      });\n    },\n    [selectableIds, maxSelection, notifyChange]\n  );\n\n  const selectAll = useCallback(() => {\n    const allIds = selectableItems.map(getItemId);\n    const idsToSelect = maxSelection ? allIds.slice(0, maxSelection) : allIds;\n    const newSet = new Set(idsToSelect);\n    setSelectedIds(newSet);\n    notifyChange(newSet);\n  }, [selectableItems, getItemId, maxSelection, notifyChange]);\n\n  const deselectAll = useCallback(() => {\n    const newSet = new Set<string>();\n    setSelectedIds(newSet);\n    notifyChange(newSet);\n  }, [notifyChange]);\n\n  const toggleAll = useCallback(() => {\n    if (state.isAllSelected) {\n      deselectAll();\n    } else {\n      selectAll();\n    }\n  }, [state.isAllSelected, selectAll, deselectAll]);\n\n  const selectMany = useCallback(\n    (ids: string[]) => {\n      setSelectedIds((prev) => {\n        const newSet = new Set(prev);\n        let count = newSet.size;\n\n        for (const id of ids) {\n          if (selectableIds.has(id) && !newSet.has(id)) {\n            if (maxSelection && count >= maxSelection) break;\n            newSet.add(id);\n            count++;\n          }\n        }\n\n        if (newSet.size === prev.size) return prev;\n        notifyChange(newSet);\n        return newSet;\n      });\n    },\n    [selectableIds, maxSelection, notifyChange]\n  );\n\n  const deselectMany = useCallback(\n    (ids: string[]) => {\n      setSelectedIds((prev) => {\n        const newSet = new Set(prev);\n        let changed = false;\n\n        for (const id of ids) {\n          if (newSet.has(id)) {\n            newSet.delete(id);\n            changed = true;\n          }\n        }\n\n        if (!changed) return prev;\n        notifyChange(newSet);\n        return newSet;\n      });\n    },\n    [notifyChange]\n  );\n\n  const setSelection = useCallback(\n    (ids: string[]) => {\n      const validIds = ids.filter((id) => selectableIds.has(id));\n      const limitedIds = maxSelection ? validIds.slice(0, maxSelection) : validIds;\n      const newSet = new Set(limitedIds);\n      setSelectedIds(newSet);\n      notifyChange(newSet);\n    },\n    [selectableIds, maxSelection, notifyChange]\n  );\n\n  // Query helpers\n  const isSelected = useCallback((id: string) => selectedIds.has(id), [selectedIds]);\n\n  const canSelect = useCallback(\n    (id: string) => {\n      if (!selectableIds.has(id)) return false;\n      if (selectedIds.has(id)) return true; // Can always deselect\n      if (maxSelection && selectedIds.size >= maxSelection) return false;\n      return true;\n    },\n    [selectableIds, selectedIds, maxSelection]\n  );\n\n  const getSelectedItems = useCallback(\n    () => items.filter((item) => selectedIds.has(getItemId(item))),\n    [items, selectedIds, getItemId]\n  );\n\n  const getSelectedIds = useCallback(\n    () => Array.from(selectedIds),\n    [selectedIds]\n  );\n\n  // Range selection\n  const selectRange = useCallback(\n    (fromId: string, toId: string) => {\n      const fromIndex = selectableItems.findIndex(\n        (item) => getItemId(item) === fromId\n      );\n      const toIndex = selectableItems.findIndex(\n        (item) => getItemId(item) === toId\n      );\n\n      if (fromIndex === -1 || toIndex === -1) return;\n\n      const start = Math.min(fromIndex, toIndex);\n      const end = Math.max(fromIndex, toIndex);\n\n      const rangeIds = selectableItems\n        .slice(start, end + 1)\n        .map(getItemId);\n\n      selectMany(rangeIds);\n    },\n    [selectableItems, getItemId, selectMany]\n  );\n\n  // Reset\n  const reset = useCallback(() => {\n    const newSet = new Set(initialSelectedIds);\n    setSelectedIds(newSet);\n    notifyChange(newSet);\n  }, [initialSelectedIds, notifyChange]);\n\n  return {\n    state,\n\n    // Selection actions\n    select,\n    deselect,\n    toggle,\n    selectAll,\n    deselectAll,\n    toggleAll,\n    selectMany,\n    deselectMany,\n    setSelection,\n\n    // Query helpers\n    isSelected,\n    canSelect,\n    getSelectedItems,\n    getSelectedIds,\n\n    // Range selection\n    selectRange,\n\n    // Reset\n    reset,\n  };\n}\n","import { useCallback, useMemo, useState } from \"react\";\nimport type {\n  ApprovalAction,\n  ApprovalFlowState,\n  ApprovalStep,\n  ApprovalStepStatus,\n  ApprovalWorkflow,\n  ApprovalWorkflowStatus,\n  Approver,\n  UseApprovalFlowOptions,\n  UseApprovalFlowReturn,\n} from \"./types\";\n\n/**\n * Calculate workflow status based on step statuses\n */\nfunction calculateWorkflowStatus(steps: ApprovalStep[]): ApprovalWorkflowStatus {\n  if (steps.length === 0) return \"draft\";\n\n  const hasRejected = steps.some((s) => s.status === \"rejected\");\n  if (hasRejected) return \"rejected\";\n\n  const hasCancelled = steps.some((s) => s.status === \"cancelled\");\n  if (hasCancelled) return \"cancelled\";\n\n  const allComplete = steps.every(\n    (s) =>\n      s.status === \"approved\" || s.status === \"skipped\" || (s.optional && s.status === \"pending\")\n  );\n  if (allComplete) return \"approved\";\n\n  const hasInProgress = steps.some(\n    (s) => s.status === \"in_review\" || s.status === \"approved\"\n  );\n  if (hasInProgress) return \"in_progress\";\n\n  const hasPending = steps.some((s) => s.status === \"pending\");\n  if (hasPending) return \"pending\";\n\n  return \"draft\";\n}\n\n/**\n * Find the current active step index\n */\nfunction findCurrentStepIndex(steps: ApprovalStep[]): number {\n  // Find the first step that is pending or in_review\n  const activeIndex = steps.findIndex(\n    (s) => s.status === \"pending\" || s.status === \"in_review\"\n  );\n\n  if (activeIndex >= 0) return activeIndex;\n\n  // If all steps are complete, return the last step\n  const allComplete = steps.every(\n    (s) => s.status === \"approved\" || s.status === \"skipped\" || s.status === \"rejected\"\n  );\n  if (allComplete && steps.length > 0) {\n    return steps.length - 1;\n  }\n\n  return 0;\n}\n\n/**\n * Check if a step has enough approvals\n */\nfunction hasEnoughApprovals(step: ApprovalStep): boolean {\n  const approvalCount = step.actions.filter((a) => a.type === \"approve\").length;\n  return approvalCount >= step.minApprovals;\n}\n\n/**\n * Hook for approval workflow state management\n *\n * Provides functionality for multi-step approval workflows\n * with support for multiple approvers, delegation, and tracking.\n *\n * @example\n * ```tsx\n * const { state, approve, reject, canApprove } = useApprovalFlow({\n *   workflow: purchaseOrderWorkflow,\n *   currentUser: currentEmployee,\n *   onApproved: (workflow) => {\n *     createPurchaseOrder(workflow.targetEntity.id);\n *   },\n *   onRejected: (workflow) => {\n *     notifyInitiator(workflow.initiator);\n *   },\n * });\n *\n * // Display progress\n * <ProgressBar value={state.progress} />\n *\n * // Render steps\n * {state.workflow.steps.map(step => (\n *   <StepCard\n *     key={step.id}\n *     step={step}\n *     isCurrent={isCurrentStep(step.id)}\n *     onApprove={() => approve(step.id)}\n *     onReject={() => reject(step.id)}\n *   />\n * ))}\n * ```\n */\nexport function useApprovalFlow(\n  options: UseApprovalFlowOptions\n): UseApprovalFlowReturn {\n  const {\n    workflow: initialWorkflow,\n    currentUser,\n    onStepChange,\n    onWorkflowChange,\n    onApproved,\n    onRejected,\n  } = options;\n\n  const [workflow, setWorkflow] = useState<ApprovalWorkflow>(initialWorkflow);\n  const [viewingStepIndex, setViewingStepIndex] = useState<number | null>(null);\n\n  // Update workflow and trigger callbacks\n  const updateWorkflow = useCallback(\n    (\n      updater: (prev: ApprovalWorkflow) => ApprovalWorkflow,\n      changedStep?: ApprovalStep\n    ) => {\n      setWorkflow((prev) => {\n        const updated = updater(prev);\n\n        // Calculate new workflow status\n        const newStatus = calculateWorkflowStatus(updated.steps);\n        const finalWorkflow: ApprovalWorkflow = {\n          ...updated,\n          status: newStatus,\n          updatedAt: new Date(),\n        };\n\n        // Trigger callbacks\n        if (changedStep) {\n          onStepChange?.(changedStep, finalWorkflow);\n        }\n        onWorkflowChange?.(finalWorkflow);\n\n        if (newStatus === \"approved\" && prev.status !== \"approved\") {\n          onApproved?.(finalWorkflow);\n        }\n        if (newStatus === \"rejected\" && prev.status !== \"rejected\") {\n          onRejected?.(finalWorkflow);\n        }\n\n        return finalWorkflow;\n      });\n    },\n    [onStepChange, onWorkflowChange, onApproved, onRejected]\n  );\n\n  // Calculate state\n  const state: ApprovalFlowState = useMemo(() => {\n    const steps = workflow.steps;\n    const currentStepIndex =\n      viewingStepIndex ?? findCurrentStepIndex(steps);\n    const currentStep = steps[currentStepIndex] ?? null;\n\n    const completedSteps = steps.filter(\n      (s) => s.status === \"approved\" || s.status === \"skipped\"\n    );\n    const pendingSteps = steps.filter(\n      (s) => s.status === \"pending\" || s.status === \"in_review\"\n    );\n\n    // Calculate progress\n    const totalSteps = steps.filter((s) => !s.optional).length;\n    const completedCount = completedSteps.filter((s) => !s.optional).length;\n    const progress = totalSteps > 0 ? (completedCount / totalSteps) * 100 : 0;\n\n    // Find user's pending action\n    let userPendingAction: ApprovalStep | null = null;\n    if (currentUser) {\n      userPendingAction =\n        pendingSteps.find((step) =>\n          step.requiredApprovers.some((a) => a.id === currentUser.id)\n        ) ?? null;\n    }\n\n    return {\n      workflow,\n      currentStepIndex,\n      currentStep,\n      completedSteps,\n      pendingSteps,\n      progress,\n      isComplete: workflow.status === \"approved\" || workflow.status === \"rejected\",\n      isApproved: workflow.status === \"approved\",\n      isRejected: workflow.status === \"rejected\",\n      canCancel:\n        workflow.status !== \"cancelled\" &&\n        workflow.status !== \"approved\" &&\n        workflow.status !== \"rejected\",\n      userPendingAction,\n    };\n  }, [workflow, viewingStepIndex, currentUser]);\n\n  // Helper to create an action\n  const createAction = useCallback(\n    (\n      type: ApprovalAction[\"type\"],\n      comment?: string,\n      delegatedTo?: Approver\n    ): ApprovalAction => {\n      const action: ApprovalAction = {\n        type,\n        approver: currentUser ?? {\n          id: \"system\",\n          name: \"System\",\n        },\n        timestamp: new Date(),\n      };\n\n      // Only add optional properties when defined (exactOptionalPropertyTypes)\n      if (comment !== undefined) {\n        action.comment = comment;\n      }\n      if (delegatedTo !== undefined) {\n        action.delegatedTo = delegatedTo;\n      }\n\n      return action;\n    },\n    [currentUser]\n  );\n\n  // Update a specific step\n  const updateStep = useCallback(\n    (\n      stepId: string,\n      updater: (step: ApprovalStep) => ApprovalStep\n    ) => {\n      updateWorkflow((prev) => {\n        const stepIndex = prev.steps.findIndex((s) => s.id === stepId);\n        if (stepIndex === -1) return prev;\n\n        const existingStep = prev.steps[stepIndex];\n        // Guard against undefined (noUncheckedIndexedAccess)\n        if (!existingStep) return prev;\n\n        const updatedStep = updater(existingStep);\n        const newSteps = [...prev.steps];\n        newSteps[stepIndex] = updatedStep;\n\n        return { ...prev, steps: newSteps };\n      });\n    },\n    [updateWorkflow]\n  );\n\n  // Step actions\n  const approve = useCallback(\n    (stepId?: string, comment?: string) => {\n      const targetStepId = stepId ?? state.currentStep?.id;\n      if (!targetStepId) return;\n\n      updateStep(targetStepId, (step) => {\n        const action = createAction(\"approve\", comment);\n        const newActions = [...step.actions, action];\n        const newStep = { ...step, actions: newActions };\n\n        // Check if step now has enough approvals\n        if (hasEnoughApprovals(newStep)) {\n          newStep.status = \"approved\";\n        } else {\n          newStep.status = \"in_review\";\n        }\n\n        return newStep;\n      });\n    },\n    [state.currentStep, updateStep, createAction]\n  );\n\n  const reject = useCallback(\n    (stepId?: string, comment?: string) => {\n      const targetStepId = stepId ?? state.currentStep?.id;\n      if (!targetStepId) return;\n\n      updateStep(targetStepId, (step) => {\n        const action = createAction(\"reject\", comment);\n        return {\n          ...step,\n          status: \"rejected\" as ApprovalStepStatus,\n          actions: [...step.actions, action],\n        };\n      });\n    },\n    [state.currentStep, updateStep, createAction]\n  );\n\n  const requestChanges = useCallback(\n    (stepId?: string, comment?: string) => {\n      const targetStepId = stepId ?? state.currentStep?.id;\n      if (!targetStepId) return;\n\n      updateStep(targetStepId, (step) => {\n        const action = createAction(\"request_changes\", comment);\n        return {\n          ...step,\n          status: \"pending\" as ApprovalStepStatus,\n          actions: [...step.actions, action],\n        };\n      });\n    },\n    [state.currentStep, updateStep, createAction]\n  );\n\n  const delegate = useCallback(\n    (stepId: string, delegateTo: Approver, comment?: string) => {\n      updateStep(stepId, (step) => {\n        const action = createAction(\"delegate\", comment, delegateTo);\n        const newApprovers = step.requiredApprovers.some(\n          (a) => a.id === delegateTo.id\n        )\n          ? step.requiredApprovers\n          : [...step.requiredApprovers, delegateTo];\n\n        return {\n          ...step,\n          requiredApprovers: newApprovers,\n          actions: [...step.actions, action],\n        };\n      });\n    },\n    [updateStep, createAction]\n  );\n\n  const skipStep = useCallback(\n    (stepId: string, comment?: string) => {\n      updateStep(stepId, (step) => {\n        if (!step.optional) return step;\n\n        const action = createAction(\"skip\", comment);\n        return {\n          ...step,\n          status: \"skipped\" as ApprovalStepStatus,\n          actions: [...step.actions, action],\n        };\n      });\n    },\n    [updateStep, createAction]\n  );\n\n  // Workflow actions\n  const cancel = useCallback(\n    (comment?: string) => {\n      updateWorkflow((prev) => ({\n        ...prev,\n        status: \"cancelled\",\n        steps: prev.steps.map((step) =>\n          step.status === \"pending\" || step.status === \"in_review\"\n            ? {\n                ...step,\n                status: \"cancelled\" as ApprovalStepStatus,\n                actions: [\n                  ...step.actions,\n                  createAction(\"skip\", comment ?? \"Workflow cancelled\"),\n                ],\n              }\n            : step\n        ),\n      }));\n    },\n    [updateWorkflow, createAction]\n  );\n\n  const resetToDraft = useCallback(() => {\n    updateWorkflow((prev) => ({\n      ...prev,\n      status: \"draft\",\n      steps: prev.steps.map((step) => ({\n        ...step,\n        status: \"pending\" as ApprovalStepStatus,\n        actions: [],\n      })),\n    }));\n  }, [updateWorkflow]);\n\n  const restart = useCallback(() => {\n    updateWorkflow((prev) => ({\n      ...prev,\n      status: \"pending\",\n      steps: prev.steps.map((step, index) => ({\n        ...step,\n        status:\n          index === 0\n            ? (\"in_review\" as ApprovalStepStatus)\n            : (\"pending\" as ApprovalStepStatus),\n        actions: [],\n      })),\n    }));\n  }, [updateWorkflow]);\n\n  // Query helpers\n  const canApprove = useCallback(\n    (stepId: string, userId?: string) => {\n      const step = workflow.steps.find((s) => s.id === stepId);\n      if (!step) return false;\n      if (step.status !== \"pending\" && step.status !== \"in_review\") return false;\n\n      const checkUserId = userId ?? currentUser?.id;\n      if (!checkUserId) return false;\n\n      // Check if user is a required approver\n      const isApprover = step.requiredApprovers.some((a) => a.id === checkUserId);\n      if (!isApprover) return false;\n\n      // Check if user hasn't already approved\n      const hasAlreadyApproved = step.actions.some(\n        (a) => a.type === \"approve\" && a.approver.id === checkUserId\n      );\n\n      return !hasAlreadyApproved;\n    },\n    [workflow.steps, currentUser]\n  );\n\n  const canReject = useCallback(\n    (stepId: string, userId?: string) => {\n      const step = workflow.steps.find((s) => s.id === stepId);\n      if (!step) return false;\n      if (step.status !== \"pending\" && step.status !== \"in_review\") return false;\n\n      const checkUserId = userId ?? currentUser?.id;\n      if (!checkUserId) return false;\n\n      return step.requiredApprovers.some((a) => a.id === checkUserId);\n    },\n    [workflow.steps, currentUser]\n  );\n\n  const isCurrentStep = useCallback(\n    (stepId: string) => state.currentStep?.id === stepId,\n    [state.currentStep]\n  );\n\n  const isStepComplete = useCallback(\n    (stepId: string) => {\n      const step = workflow.steps.find((s) => s.id === stepId);\n      return step?.status === \"approved\" || step?.status === \"skipped\";\n    },\n    [workflow.steps]\n  );\n\n  const getStep = useCallback(\n    (stepId: string) => workflow.steps.find((s) => s.id === stepId),\n    [workflow.steps]\n  );\n\n  const getStepApprovers = useCallback(\n    (stepId: string) => {\n      const step = workflow.steps.find((s) => s.id === stepId);\n      return step?.requiredApprovers ?? [];\n    },\n    [workflow.steps]\n  );\n\n  const getRemainingApprovers = useCallback(\n    (stepId: string) => {\n      const step = workflow.steps.find((s) => s.id === stepId);\n      if (!step) return [];\n\n      const approvedUserIds = new Set(\n        step.actions.filter((a) => a.type === \"approve\").map((a) => a.approver.id)\n      );\n\n      return step.requiredApprovers.filter((a) => !approvedUserIds.has(a.id));\n    },\n    [workflow.steps]\n  );\n\n  // Navigation\n  const goToStep = useCallback(\n    (stepId: string) => {\n      const index = workflow.steps.findIndex((s) => s.id === stepId);\n      if (index >= 0) {\n        setViewingStepIndex(index);\n      }\n    },\n    [workflow.steps]\n  );\n\n  const getNextStep = useCallback((): ApprovalStep | null => {\n    const nextIndex = state.currentStepIndex + 1;\n    const nextStep = workflow.steps[nextIndex];\n    return nextStep !== undefined ? nextStep : null;\n  }, [workflow.steps, state.currentStepIndex]);\n\n  const getPreviousStep = useCallback((): ApprovalStep | null => {\n    const prevIndex = state.currentStepIndex - 1;\n    if (prevIndex < 0) return null;\n    const prevStep = workflow.steps[prevIndex];\n    return prevStep !== undefined ? prevStep : null;\n  }, [workflow.steps, state.currentStepIndex]);\n\n  return {\n    state,\n\n    // Step actions\n    approve,\n    reject,\n    requestChanges,\n    delegate,\n    skipStep,\n\n    // Workflow actions\n    cancel,\n    resetToDraft,\n    restart,\n\n    // Query helpers\n    canApprove,\n    canReject,\n    isCurrentStep,\n    isStepComplete,\n    getStep,\n    getStepApprovers,\n    getRemainingApprovers,\n\n    // Navigation\n    goToStep,\n    getNextStep,\n    getPreviousStep,\n  };\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport type {\n  CurrencyConfig,\n  SpendingLimit,\n  SpendingMeterState,\n  SpendingThreshold,\n  ThresholdLevel,\n  UseSpendingMeterOptions,\n  UseSpendingMeterReturn,\n} from \"./types\";\nimport { DEFAULT_CURRENCY, DEFAULT_THRESHOLDS } from \"./types\";\n\n/**\n * Default currency formatter\n */\nfunction defaultFormatCurrency(amount: number, currency: CurrencyConfig): string {\n  const absAmount = Math.abs(amount);\n  const sign = amount < 0 ? \"-\" : \"\";\n\n  // Format the number\n  const parts = absAmount.toFixed(currency.decimals).split(\".\");\n  const integerPart = (parts[0] ?? \"0\").replace(\n    /\\B(?=(\\d{3})+(?!\\d))/g,\n    currency.thousandsSeparator\n  );\n  const decimalPart = parts[1];\n\n  const formattedNumber = decimalPart\n    ? `${integerPart}${currency.decimalSeparator}${decimalPart}`\n    : integerPart;\n\n  // Add symbol\n  if (currency.symbolPosition === \"before\") {\n    return `${sign}${currency.symbol}${formattedNumber}`;\n  }\n  return `${sign}${formattedNumber} ${currency.symbol}`;\n}\n\n/**\n * Calculate days between two dates\n */\nfunction daysBetween(start: Date, end: Date): number {\n  const msPerDay = 24 * 60 * 60 * 1000;\n  return Math.ceil((end.getTime() - start.getTime()) / msPerDay);\n}\n\n/**\n * Get threshold level for a percentage\n */\nfunction getThresholdLevelForPercentage(\n  percentage: number,\n  thresholds: SpendingThreshold[]\n): ThresholdLevel {\n  // Sort thresholds by percentage descending\n  const sorted = [...thresholds].sort((a, b) => b.percentage - a.percentage);\n\n  for (const threshold of sorted) {\n    if (percentage >= threshold.percentage) {\n      return threshold.level;\n    }\n  }\n\n  return \"safe\";\n}\n\n/**\n * Get active threshold for a percentage\n */\nfunction getActiveThreshold(\n  percentage: number,\n  thresholds: SpendingThreshold[]\n): SpendingThreshold {\n  const level = getThresholdLevelForPercentage(percentage, thresholds);\n  const found = thresholds.find((t) => t.level === level);\n  if (found) return found;\n\n  // Fallback to first threshold or create a default\n  const first = thresholds[0];\n  return first ?? { level: \"safe\", percentage: 0, label: \"Safe\", color: \"#22c55e\" };\n}\n\n/**\n * Hook for spending meter state management\n *\n * Provides budget tracking with threshold calculations,\n * projections, and warning states.\n *\n * @example\n * ```tsx\n * const { state, addSpending, canSpend } = useSpendingMeter({\n *   limit: employeeSpendingLimit,\n *   onThresholdChange: (level) => {\n *     if (level === 'danger') {\n *       showWarningToast('Approaching spending limit!');\n *     }\n *   },\n *   onLimitExceeded: () => {\n *     showErrorToast('Spending limit exceeded!');\n *   },\n * });\n *\n * // Display gauge\n * <ProgressBar\n *   value={state.displayPercentage}\n *   color={state.activeThreshold.color}\n * />\n * <p>{state.formattedSpent} / {state.formattedLimit}</p>\n * <p>{state.formattedRemaining} remaining</p>\n *\n * // Before making a purchase\n * if (canSpend(orderTotal)) {\n *   addSpending(orderTotal);\n * }\n * ```\n */\nexport function useSpendingMeter(\n  options: UseSpendingMeterOptions\n): UseSpendingMeterReturn {\n  const {\n    limit: initialLimit,\n    warningThreshold = 75,\n    dangerThreshold = 90,\n    onThresholdChange,\n    onLimitExceeded,\n    onSoftLimitExceeded,\n    formatCurrency = defaultFormatCurrency,\n  } = options;\n\n  const [limit, setLimit] = useState<SpendingLimit>(initialLimit);\n  const previousThresholdRef = useRef<ThresholdLevel | null>(null);\n\n  // Build thresholds\n  const thresholds = useMemo((): SpendingThreshold[] => {\n    if (limit.thresholds && limit.thresholds.length > 0) {\n      return limit.thresholds;\n    }\n\n    return [\n      { level: \"safe\", percentage: 0, label: \"On Track\", color: \"#22c55e\" },\n      {\n        level: \"warning\",\n        percentage: warningThreshold,\n        label: \"Approaching Limit\",\n        color: \"#f59e0b\",\n      },\n      {\n        level: \"danger\",\n        percentage: dangerThreshold,\n        label: \"Near Limit\",\n        color: \"#ef4444\",\n      },\n      {\n        level: \"exceeded\",\n        percentage: 100,\n        label: \"Limit Exceeded\",\n        color: \"#dc2626\",\n      },\n    ];\n  }, [limit.thresholds, warningThreshold, dangerThreshold]);\n\n  // Calculate state\n  const state: SpendingMeterState = useMemo(() => {\n    const spent = limit.spentAmount;\n    const maxAmount = limit.maxAmount;\n    const remaining = Math.max(0, maxAmount - spent);\n    const percentage = maxAmount > 0 ? (spent / maxAmount) * 100 : 0;\n    const displayPercentage = Math.min(100, percentage);\n\n    const thresholdLevel = getThresholdLevelForPercentage(percentage, thresholds);\n    const activeThreshold = getActiveThreshold(percentage, thresholds);\n\n    const isExceeded = spent > maxAmount;\n    const isSoftLimitExceeded = limit.softLimit\n      ? spent > limit.softLimit\n      : percentage >= warningThreshold;\n    const isHardLimitExceeded = limit.hardLimit\n      ? spent > limit.hardLimit\n      : isExceeded;\n\n    const currency = limit.currency ?? DEFAULT_CURRENCY;\n    const formattedSpent = formatCurrency(spent, currency);\n    const formattedRemaining = formatCurrency(remaining, currency);\n    const formattedLimit = formatCurrency(maxAmount, currency);\n\n    // Period calculations\n    const now = new Date();\n    const daysInPeriod = daysBetween(limit.periodStart, limit.periodEnd);\n    const daysElapsed = Math.max(1, daysBetween(limit.periodStart, now));\n    const daysRemaining = Math.max(0, daysBetween(now, limit.periodEnd));\n\n    const averageDailySpending = spent / daysElapsed;\n    const projectedSpending = averageDailySpending * daysInPeriod;\n    const isOnTrack = projectedSpending <= maxAmount;\n\n    return {\n      limit,\n      spent,\n      remaining,\n      percentage,\n      displayPercentage,\n      thresholdLevel,\n      activeThreshold,\n      thresholds,\n      isExceeded,\n      isSoftLimitExceeded,\n      isHardLimitExceeded,\n      formattedSpent,\n      formattedRemaining,\n      formattedLimit,\n      daysRemaining,\n      averageDailySpending,\n      projectedSpending,\n      isOnTrack,\n    };\n  }, [limit, thresholds, warningThreshold, formatCurrency]);\n\n  // Track threshold changes and trigger callbacks\n  useEffect(() => {\n    const currentLevel = state.thresholdLevel;\n\n    if (previousThresholdRef.current !== null) {\n      if (previousThresholdRef.current !== currentLevel) {\n        onThresholdChange?.(currentLevel, state);\n      }\n    }\n\n    previousThresholdRef.current = currentLevel;\n  }, [state.thresholdLevel, state, onThresholdChange]);\n\n  // Track limit exceeded\n  useEffect(() => {\n    if (state.isExceeded) {\n      onLimitExceeded?.(state);\n    }\n  }, [state.isExceeded, state, onLimitExceeded]);\n\n  // Track soft limit exceeded\n  useEffect(() => {\n    if (state.isSoftLimitExceeded) {\n      onSoftLimitExceeded?.(state);\n    }\n  }, [state.isSoftLimitExceeded, state, onSoftLimitExceeded]);\n\n  // Actions\n  const setSpent = useCallback((amount: number) => {\n    setLimit((prev) => ({\n      ...prev,\n      spentAmount: Math.max(0, amount),\n    }));\n  }, []);\n\n  const addSpending = useCallback((amount: number) => {\n    setLimit((prev) => ({\n      ...prev,\n      spentAmount: Math.max(0, prev.spentAmount + amount),\n    }));\n  }, []);\n\n  const updateLimit = useCallback((updates: Partial<SpendingLimit>) => {\n    setLimit((prev) => ({\n      ...prev,\n      ...updates,\n    }));\n  }, []);\n\n  const resetSpending = useCallback(() => {\n    setLimit((prev) => ({\n      ...prev,\n      spentAmount: 0,\n    }));\n    previousThresholdRef.current = null;\n  }, []);\n\n  // Query helpers\n  const canSpend = useCallback(\n    (amount: number): boolean => {\n      if (!limit.isActive) return true;\n      if (limit.allowExceed) return true;\n\n      const newTotal = limit.spentAmount + amount;\n\n      if (limit.hardLimit && newTotal > limit.hardLimit) {\n        return false;\n      }\n\n      return newTotal <= limit.maxAmount;\n    },\n    [limit]\n  );\n\n  const getSpendableAmount = useCallback((): number => {\n    if (!limit.isActive || limit.allowExceed) {\n      return Infinity;\n    }\n\n    const maxAllowed = limit.hardLimit ?? limit.maxAmount;\n    return Math.max(0, maxAllowed - limit.spentAmount);\n  }, [limit]);\n\n  const wouldTriggerWarning = useCallback(\n    (amount: number): boolean => {\n      const newPercentage =\n        ((limit.spentAmount + amount) / limit.maxAmount) * 100;\n      return newPercentage >= warningThreshold;\n    },\n    [limit, warningThreshold]\n  );\n\n  const wouldExceedLimit = useCallback(\n    (amount: number): boolean => {\n      return limit.spentAmount + amount > limit.maxAmount;\n    },\n    [limit]\n  );\n\n  // Formatting helpers\n  const formatAmount = useCallback(\n    (amount: number): string => {\n      return formatCurrency(amount, limit.currency ?? DEFAULT_CURRENCY);\n    },\n    [formatCurrency, limit.currency]\n  );\n\n  const getPercentage = useCallback(\n    (amount: number): number => {\n      return limit.maxAmount > 0 ? (amount / limit.maxAmount) * 100 : 0;\n    },\n    [limit.maxAmount]\n  );\n\n  const getThresholdLevel = useCallback(\n    (percentage: number): ThresholdLevel => {\n      return getThresholdLevelForPercentage(percentage, thresholds);\n    },\n    [thresholds]\n  );\n\n  return {\n    state,\n\n    // Actions\n    setSpent,\n    addSpending,\n    updateLimit,\n    resetSpending,\n\n    // Query helpers\n    canSpend,\n    getSpendableAmount,\n    wouldTriggerWarning,\n    wouldExceedLimit,\n\n    // Formatting helpers\n    formatAmount,\n    getPercentage,\n    getThresholdLevel,\n  };\n}\n","/**\n * SpendingMeter Types\n *\n * Type definitions for budget usage gauge component\n * with threshold calculations and warning states.\n */\n\n/**\n * Spending threshold level\n */\nexport type ThresholdLevel = \"safe\" | \"warning\" | \"danger\" | \"exceeded\";\n\n/**\n * Spending period type\n */\nexport type SpendingPeriod =\n  | \"daily\"\n  | \"weekly\"\n  | \"monthly\"\n  | \"quarterly\"\n  | \"yearly\"\n  | \"custom\";\n\n/**\n * Currency configuration\n */\nexport interface CurrencyConfig {\n  /** Currency code (e.g., 'EUR', 'USD') */\n  code: string;\n  /** Currency symbol (e.g., '$', '???') */\n  symbol: string;\n  /** Decimal places */\n  decimals: number;\n  /** Symbol position */\n  symbolPosition: \"before\" | \"after\";\n  /** Thousands separator */\n  thousandsSeparator: string;\n  /** Decimal separator */\n  decimalSeparator: string;\n}\n\n/**\n * Spending threshold configuration\n */\nexport interface SpendingThreshold {\n  /** Threshold level name */\n  level: ThresholdLevel;\n  /** Percentage at which this threshold starts (0-100) */\n  percentage: number;\n  /** Custom label for this threshold */\n  label?: string;\n  /** Color associated with this threshold */\n  color?: string;\n}\n\n/**\n * Spending limit configuration\n */\nexport interface SpendingLimit {\n  /** Unique limit ID */\n  id: string;\n  /** Limit name/label */\n  name: string;\n  /** Maximum spending amount */\n  maxAmount: number;\n  /** Current spent amount */\n  spentAmount: number;\n  /** Spending period */\n  period: SpendingPeriod;\n  /** Period start date */\n  periodStart: Date;\n  /** Period end date */\n  periodEnd: Date;\n  /** Currency configuration */\n  currency: CurrencyConfig;\n  /** Custom thresholds */\n  thresholds?: SpendingThreshold[];\n  /** Whether this limit is active */\n  isActive: boolean;\n  /** Whether to allow exceeding the limit */\n  allowExceed: boolean;\n  /** Soft limit (warning threshold) */\n  softLimit?: number;\n  /** Hard limit (absolute maximum) */\n  hardLimit?: number;\n}\n\n/**\n * Spending meter state\n */\nexport interface SpendingMeterState {\n  /** Current spending limit configuration */\n  limit: SpendingLimit;\n  /** Amount spent */\n  spent: number;\n  /** Remaining amount */\n  remaining: number;\n  /** Usage percentage (0-100+) */\n  percentage: number;\n  /** Capped percentage for display (0-100) */\n  displayPercentage: number;\n  /** Current threshold level */\n  thresholdLevel: ThresholdLevel;\n  /** Active threshold configuration */\n  activeThreshold: SpendingThreshold;\n  /** All thresholds for display */\n  thresholds: SpendingThreshold[];\n  /** Whether limit is exceeded */\n  isExceeded: boolean;\n  /** Whether soft limit is exceeded */\n  isSoftLimitExceeded: boolean;\n  /** Whether hard limit is exceeded */\n  isHardLimitExceeded: boolean;\n  /** Formatted spent amount */\n  formattedSpent: string;\n  /** Formatted remaining amount */\n  formattedRemaining: string;\n  /** Formatted limit amount */\n  formattedLimit: string;\n  /** Days remaining in period */\n  daysRemaining: number;\n  /** Average daily spending */\n  averageDailySpending: number;\n  /** Projected end-of-period spending */\n  projectedSpending: number;\n  /** Whether on track to stay under limit */\n  isOnTrack: boolean;\n}\n\n/**\n * Options for useSpendingMeter hook\n */\nexport interface UseSpendingMeterOptions {\n  /** Spending limit configuration */\n  limit: SpendingLimit;\n  /** Warning threshold percentage (default: 75) */\n  warningThreshold?: number;\n  /** Danger threshold percentage (default: 90) */\n  dangerThreshold?: number;\n  /** Callback when threshold level changes */\n  onThresholdChange?: (level: ThresholdLevel, state: SpendingMeterState) => void;\n  /** Callback when limit is exceeded */\n  onLimitExceeded?: (state: SpendingMeterState) => void;\n  /** Callback when soft limit is exceeded */\n  onSoftLimitExceeded?: (state: SpendingMeterState) => void;\n  /** Custom currency formatter */\n  formatCurrency?: (amount: number, currency: CurrencyConfig) => string;\n}\n\n/**\n * Return type for useSpendingMeter hook\n */\nexport interface UseSpendingMeterReturn {\n  /** Current state */\n  state: SpendingMeterState;\n\n  // Actions\n  /** Update spent amount */\n  setSpent: (amount: number) => void;\n  /** Add to spent amount */\n  addSpending: (amount: number) => void;\n  /** Update limit configuration */\n  updateLimit: (limit: Partial<SpendingLimit>) => void;\n  /** Reset spending to zero */\n  resetSpending: () => void;\n\n  // Query helpers\n  /** Check if an amount can be spent */\n  canSpend: (amount: number) => boolean;\n  /** Get amount that can still be spent */\n  getSpendableAmount: () => number;\n  /** Check if spending amount would trigger warning */\n  wouldTriggerWarning: (amount: number) => boolean;\n  /** Check if spending amount would exceed limit */\n  wouldExceedLimit: (amount: number) => boolean;\n\n  // Formatting helpers\n  /** Format an amount with currency */\n  formatAmount: (amount: number) => string;\n  /** Get percentage for a given amount */\n  getPercentage: (amount: number) => number;\n  /** Get threshold level for a given percentage */\n  getThresholdLevel: (percentage: number) => ThresholdLevel;\n}\n\n/**\n * Default thresholds\n */\nexport const DEFAULT_THRESHOLDS: SpendingThreshold[] = [\n  { level: \"safe\", percentage: 0, label: \"On Track\", color: \"#22c55e\" },\n  { level: \"warning\", percentage: 75, label: \"Approaching Limit\", color: \"#f59e0b\" },\n  { level: \"danger\", percentage: 90, label: \"Near Limit\", color: \"#ef4444\" },\n  { level: \"exceeded\", percentage: 100, label: \"Limit Exceeded\", color: \"#dc2626\" },\n];\n\n/**\n * Default currency configuration (EUR)\n */\nexport const DEFAULT_CURRENCY: CurrencyConfig = {\n  code: \"EUR\",\n  symbol: \"\\u20AC\",\n  decimals: 2,\n  symbolPosition: \"after\",\n  thousandsSeparator: \" \",\n  decimalSeparator: \",\",\n};\n","import { useCallback, useMemo, useState } from \"react\";\nimport type {\n  CartItem,\n  Quote,\n  QuoteBuilderState,\n  QuoteCustomer,\n  QuoteDiscount,\n  QuoteLineItem,\n  QuotePricing,\n  QuoteTerms,\n  QuoteValidationError,\n  TaxType,\n  UseQuoteBuilderOptions,\n  UseQuoteBuilderReturn,\n} from \"./types\";\n\n/**\n * Generate a unique ID\n */\nfunction generateId(): string {\n  return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n\n/**\n * Default quote number generator\n */\nfunction defaultGenerateQuoteNumber(): string {\n  const date = new Date();\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, \"0\");\n  const random = Math.random().toString(36).substring(2, 6).toUpperCase();\n  return `Q-${year}${month}-${random}`;\n}\n\n/**\n * Calculate effective unit price after discount\n */\nfunction calculateEffectiveUnitPrice(\n  unitPrice: number,\n  discount?: QuoteLineItem[\"discount\"]\n): number {\n  if (!discount) return unitPrice;\n\n  switch (discount.type) {\n    case \"percentage\":\n      return unitPrice * (1 - discount.value / 100);\n    case \"fixed\":\n      return Math.max(0, unitPrice - discount.value);\n    case \"per_unit\":\n      return Math.max(0, unitPrice - discount.value);\n    default:\n      return unitPrice;\n  }\n}\n\n/**\n * Calculate line total\n */\nfunction calculateLineTotal(\n  effectiveUnitPrice: number,\n  quantity: number,\n  taxRate?: number,\n  includeTax?: boolean\n): { lineTotal: number; taxAmount: number } {\n  const subtotal = effectiveUnitPrice * quantity;\n  const taxAmount = taxRate ? subtotal * (taxRate / 100) : 0;\n  const lineTotal = includeTax ? subtotal + taxAmount : subtotal;\n\n  return { lineTotal, taxAmount };\n}\n\n/**\n * Calculate quote-level discount amount\n */\nfunction calculateQuoteDiscount(\n  subtotal: number,\n  discount: QuoteDiscount\n): number {\n  if (discount.minOrderValue && subtotal < discount.minOrderValue) {\n    return 0;\n  }\n\n  let amount: number;\n  switch (discount.type) {\n    case \"percentage\":\n      amount = subtotal * (discount.value / 100);\n      break;\n    case \"fixed\":\n      amount = discount.value;\n      break;\n    default:\n      amount = 0;\n  }\n\n  if (discount.maxDiscount) {\n    amount = Math.min(amount, discount.maxDiscount);\n  }\n\n  return amount;\n}\n\n/**\n * Calculate complete pricing summary\n */\nfunction calculatePricing(\n  items: QuoteLineItem[],\n  discounts: QuoteDiscount[],\n  shipping: number,\n  taxRate: number,\n  taxType: TaxType,\n  currency: string\n): QuotePricing {\n  // Calculate subtotal from all line items\n  const subtotal = items.reduce((sum, item) => sum + item.lineTotal, 0);\n\n  // Calculate total discounts\n  const discountTotal = discounts.reduce(\n    (sum, discount) => sum + calculateQuoteDiscount(subtotal, discount),\n    0\n  );\n\n  // Discounted subtotal\n  const discountedSubtotal = Math.max(0, subtotal - discountTotal);\n\n  // Calculate tax\n  let taxAmount = 0;\n  if (taxType !== \"exempt\") {\n    const taxableAmount = discountedSubtotal + shipping;\n    taxAmount = taxableAmount * (taxRate / 100);\n  }\n\n  // Calculate total\n  let total = discountedSubtotal + shipping;\n  if (taxType === \"excluded\") {\n    total += taxAmount;\n  }\n\n  return {\n    subtotal,\n    discountTotal,\n    discountedSubtotal,\n    shipping,\n    taxType,\n    taxRate,\n    taxAmount,\n    total,\n    currency,\n  };\n}\n\n/**\n * Create initial quote\n */\nfunction createInitialQuote(\n  options: UseQuoteBuilderOptions,\n  generateQuoteNumber: () => string\n): Quote {\n  const now = new Date();\n  const validityDays = options.validityDays ?? 30;\n  const expirationDate = new Date(now);\n  expirationDate.setDate(expirationDate.getDate() + validityDays);\n\n  const initialQuote: Quote = {\n    id: options.initialQuote?.id ?? generateId(),\n    quoteNumber: options.initialQuote?.quoteNumber ?? generateQuoteNumber(),\n    status: options.initialQuote?.status ?? \"draft\",\n    customer: options.customer,\n    items: options.initialQuote?.items ?? [],\n    discounts: options.initialQuote?.discounts ?? [],\n    pricing: options.initialQuote?.pricing ?? {\n      subtotal: 0,\n      discountTotal: 0,\n      discountedSubtotal: 0,\n      shipping: 0,\n      taxType: options.taxType ?? \"excluded\",\n      taxRate: options.taxRate ?? 20,\n      taxAmount: 0,\n      total: 0,\n      currency: options.currency ?? \"EUR\",\n    },\n    terms: options.initialQuote?.terms ?? {\n      paymentTerms: options.paymentTerms ?? \"NET30\",\n      validityDays,\n      expirationDate,\n    },\n    createdBy: options.initialQuote?.createdBy ?? {\n      id: \"\",\n      name: \"\",\n      email: \"\",\n    },\n    createdAt: options.initialQuote?.createdAt ?? now,\n    updatedAt: now,\n    version: options.initialQuote?.version ?? 1,\n  };\n\n  // Add optional metadata only if present\n  if (options.initialQuote?.metadata) {\n    initialQuote.metadata = options.initialQuote.metadata;\n  }\n\n  return initialQuote;\n}\n\n/**\n * Validate quote\n */\nfunction validateQuote(quote: Quote): QuoteValidationError[] {\n  const errors: QuoteValidationError[] = [];\n\n  // Validate items\n  if (quote.items.length === 0) {\n    errors.push({\n      field: \"items\",\n      message: \"Quote must have at least one item\",\n      type: \"error\",\n    });\n  }\n\n  // Validate quantities\n  quote.items.forEach((item, index) => {\n    if (item.quantity <= 0) {\n      errors.push({\n        field: `items[${index}].quantity`,\n        message: `Item \"${item.name}\" must have a positive quantity`,\n        type: \"error\",\n      });\n    }\n    if (item.unitPrice < 0) {\n      errors.push({\n        field: `items[${index}].unitPrice`,\n        message: `Item \"${item.name}\" cannot have a negative price`,\n        type: \"error\",\n      });\n    }\n  });\n\n  // Validate customer\n  if (!quote.customer.companyName) {\n    errors.push({\n      field: \"customer.companyName\",\n      message: \"Company name is required\",\n      type: \"error\",\n    });\n  }\n  if (!quote.customer.email) {\n    errors.push({\n      field: \"customer.email\",\n      message: \"Customer email is required\",\n      type: \"error\",\n    });\n  }\n\n  // Validate expiration\n  if (quote.terms.expirationDate < new Date()) {\n    errors.push({\n      field: \"terms.expirationDate\",\n      message: \"Quote expiration date is in the past\",\n      type: \"warning\",\n    });\n  }\n\n  return errors;\n}\n\n/**\n * Hook for quote building functionality\n *\n * Provides comprehensive quote construction from cart items\n * with support for discounts, taxes, and custom terms.\n *\n * @example\n * ```tsx\n * const {\n *   state,\n *   addItem,\n *   importFromCart,\n *   setShipping,\n *   save,\n *   send,\n * } = useQuoteBuilder({\n *   customer: selectedCustomer,\n *   currency: 'EUR',\n *   taxRate: 20,\n *   validityDays: 30,\n *   onSend: async (quote) => {\n *     await emailQuoteToCustomer(quote);\n *   },\n * });\n *\n * // Import from cart\n * importFromCart(cartItems);\n *\n * // Apply bulk discount\n * addDiscount({ type: 'percentage', value: 10, reason: 'Volume discount' });\n *\n * // Display quote\n * <QuotePreview\n *   items={state.quote.items}\n *   pricing={state.quote.pricing}\n *   onSend={send}\n * />\n * ```\n */\nexport function useQuoteBuilder(\n  options: UseQuoteBuilderOptions\n): UseQuoteBuilderReturn {\n  const {\n    customer,\n    currency = \"EUR\",\n    taxRate = 20,\n    taxType = \"excluded\",\n    autoCalculate = true,\n    generateQuoteNumber = defaultGenerateQuoteNumber,\n    onChange,\n    onSave,\n    onSend,\n  } = options;\n\n  const [quote, setQuote] = useState<Quote>(() =>\n    createInitialQuote(options, generateQuoteNumber)\n  );\n  const [isDirty, setIsDirty] = useState(false);\n  const [selectedItems, setSelectedItems] = useState<Set<string>>(new Set());\n\n  // Recalculate pricing\n  const recalculatePricing = useCallback(\n    (currentQuote: Quote): Quote => {\n      const pricing = calculatePricing(\n        currentQuote.items,\n        currentQuote.discounts,\n        currentQuote.pricing.shipping,\n        currentQuote.pricing.taxRate,\n        currentQuote.pricing.taxType,\n        currentQuote.pricing.currency\n      );\n\n      return {\n        ...currentQuote,\n        pricing,\n        updatedAt: new Date(),\n      };\n    },\n    []\n  );\n\n  // Update quote with optional recalculation\n  const updateQuote = useCallback(\n    (updater: (prev: Quote) => Quote) => {\n      setQuote((prev) => {\n        let updated = updater(prev);\n\n        if (autoCalculate) {\n          updated = recalculatePricing(updated);\n        }\n\n        setIsDirty(true);\n        onChange?.(updated);\n\n        return updated;\n      });\n    },\n    [autoCalculate, recalculatePricing, onChange]\n  );\n\n  // Calculate line item totals\n  const calculateItemTotals = useCallback(\n    (item: Partial<QuoteLineItem>): QuoteLineItem => {\n      const unitPrice = item.unitPrice ?? 0;\n      const quantity = item.quantity ?? 1;\n      const effectiveUnitPrice = calculateEffectiveUnitPrice(\n        unitPrice,\n        item.discount\n      );\n      const { lineTotal, taxAmount: calculatedTaxAmount } = calculateLineTotal(\n        effectiveUnitPrice,\n        quantity,\n        item.taxRate ?? taxRate,\n        taxType === \"included\"\n      );\n\n      // Build result with only defined optional properties\n      const result: QuoteLineItem = {\n        id: item.id ?? generateId(),\n        productId: item.productId ?? \"\",\n        name: item.name ?? \"\",\n        quantity,\n        unitPrice,\n        effectiveUnitPrice,\n        lineTotal,\n      };\n\n      // Conditionally add optional properties\n      if (item.description !== undefined) result.description = item.description;\n      if (item.sku !== undefined) result.sku = item.sku;\n      if (item.unit !== undefined) result.unit = item.unit;\n      if (item.discount !== undefined) result.discount = item.discount;\n      result.taxRate = item.taxRate ?? taxRate;\n      result.taxAmount = calculatedTaxAmount;\n      if (item.customizable !== undefined) result.customizable = item.customizable;\n      if (item.customOptions !== undefined) result.customOptions = item.customOptions;\n      if (item.leadTime !== undefined) result.leadTime = item.leadTime;\n      if (item.notes !== undefined) result.notes = item.notes;\n      if (item.cartItemId !== undefined) result.cartItemId = item.cartItemId;\n\n      return result;\n    },\n    [taxRate, taxType]\n  );\n\n  // Validation\n  const errors = useMemo(() => validateQuote(quote), [quote]);\n  const isValid = errors.filter((e) => e.type === \"error\").length === 0;\n\n  // State\n  const state: QuoteBuilderState = useMemo(\n    () => ({\n      quote,\n      isDirty,\n      errors,\n      isValid,\n      selectedItems,\n    }),\n    [quote, isDirty, errors, isValid, selectedItems]\n  );\n\n  // Line item actions\n  const addItem = useCallback(\n    (item: Omit<QuoteLineItem, \"id\" | \"effectiveUnitPrice\" | \"lineTotal\">) => {\n      const newItem = calculateItemTotals(item);\n      updateQuote((prev) => ({\n        ...prev,\n        items: [...prev.items, newItem],\n      }));\n    },\n    [calculateItemTotals, updateQuote]\n  );\n\n  const updateItem = useCallback(\n    (itemId: string, updates: Partial<QuoteLineItem>) => {\n      updateQuote((prev) => ({\n        ...prev,\n        items: prev.items.map((item) =>\n          item.id === itemId\n            ? calculateItemTotals({ ...item, ...updates })\n            : item\n        ),\n      }));\n    },\n    [calculateItemTotals, updateQuote]\n  );\n\n  const removeItem = useCallback(\n    (itemId: string) => {\n      updateQuote((prev) => ({\n        ...prev,\n        items: prev.items.filter((item) => item.id !== itemId),\n      }));\n      setSelectedItems((prev) => {\n        const newSet = new Set(prev);\n        newSet.delete(itemId);\n        return newSet;\n      });\n    },\n    [updateQuote]\n  );\n\n  const duplicateItem = useCallback(\n    (itemId: string) => {\n      const item = quote.items.find((i) => i.id === itemId);\n      if (item) {\n        const newItem = calculateItemTotals({\n          ...item,\n          id: generateId(),\n          notes: `Copy of: ${item.name}`,\n        });\n        updateQuote((prev) => {\n          const index = prev.items.findIndex((i) => i.id === itemId);\n          const newItems = [...prev.items];\n          newItems.splice(index + 1, 0, newItem);\n          return { ...prev, items: newItems };\n        });\n      }\n    },\n    [quote.items, calculateItemTotals, updateQuote]\n  );\n\n  const setItemQuantity = useCallback(\n    (itemId: string, quantity: number) => {\n      updateItem(itemId, { quantity: Math.max(1, quantity) });\n    },\n    [updateItem]\n  );\n\n  const applyItemDiscount = useCallback(\n    (itemId: string, discount: QuoteLineItem[\"discount\"]) => {\n      if (discount) {\n        updateItem(itemId, { discount });\n      }\n    },\n    [updateItem]\n  );\n\n  const clearItemDiscount = useCallback(\n    (itemId: string) => {\n      // To clear discount, we need to update the item without the discount property\n      updateQuote((prev) => ({\n        ...prev,\n        items: prev.items.map((item) => {\n          if (item.id !== itemId) return item;\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          const { discount: _, ...itemWithoutDiscount } = item;\n          return calculateItemTotals(itemWithoutDiscount);\n        }),\n      }));\n    },\n    [updateQuote, calculateItemTotals]\n  );\n\n  const reorderItems = useCallback(\n    (fromIndex: number, toIndex: number) => {\n      updateQuote((prev) => {\n        // Validate indices\n        if (fromIndex < 0 || fromIndex >= prev.items.length) return prev;\n        if (toIndex < 0 || toIndex > prev.items.length) return prev;\n\n        const newItems = [...prev.items];\n        // splice returns array, destructure to get first element\n        const [removed] = newItems.splice(fromIndex, 1);\n        // TypeScript control flow analysis with destructuring\n        if (removed === undefined) return prev;\n        newItems.splice(toIndex, 0, removed);\n        return { ...prev, items: newItems };\n      });\n    },\n    [updateQuote]\n  );\n\n  // Helper to convert cart item to partial line item\n  const cartItemToPartial = useCallback(\n    (cartItem: CartItem): Partial<QuoteLineItem> => {\n      const partial: Partial<QuoteLineItem> = {\n        productId: cartItem.productId,\n        name: cartItem.name,\n        quantity: cartItem.quantity,\n        unitPrice: cartItem.unitPrice,\n        cartItemId: cartItem.id,\n      };\n      if (cartItem.description) partial.description = cartItem.description;\n      if (cartItem.sku) partial.sku = cartItem.sku;\n      if (cartItem.customOptions) partial.customOptions = cartItem.customOptions;\n      return partial;\n    },\n    []\n  );\n\n  // Cart conversion\n  const importFromCart = useCallback(\n    (cartItems: CartItem[]) => {\n      const newItems = cartItems.map((cartItem) =>\n        calculateItemTotals(cartItemToPartial(cartItem))\n      );\n\n      updateQuote((prev) => ({\n        ...prev,\n        items: [...prev.items, ...newItems],\n      }));\n    },\n    [calculateItemTotals, cartItemToPartial, updateQuote]\n  );\n\n  const replaceFromCart = useCallback(\n    (cartItems: CartItem[]) => {\n      const newItems = cartItems.map((cartItem) =>\n        calculateItemTotals(cartItemToPartial(cartItem))\n      );\n\n      updateQuote((prev) => ({\n        ...prev,\n        items: newItems,\n      }));\n      setSelectedItems(new Set());\n    },\n    [calculateItemTotals, updateQuote]\n  );\n\n  // Quote-level discount actions\n  const addDiscount = useCallback(\n    (discount: Omit<QuoteDiscount, \"id\">) => {\n      const newDiscount: QuoteDiscount = {\n        ...discount,\n        id: generateId(),\n      };\n      updateQuote((prev) => ({\n        ...prev,\n        discounts: [...prev.discounts, newDiscount],\n      }));\n    },\n    [updateQuote]\n  );\n\n  const removeDiscount = useCallback(\n    (discountId: string) => {\n      updateQuote((prev) => ({\n        ...prev,\n        discounts: prev.discounts.filter((d) => d.id !== discountId),\n      }));\n    },\n    [updateQuote]\n  );\n\n  const clearDiscounts = useCallback(() => {\n    updateQuote((prev) => ({\n      ...prev,\n      discounts: [],\n    }));\n  }, [updateQuote]);\n\n  // Pricing actions\n  const setShipping = useCallback(\n    (amount: number) => {\n      updateQuote((prev) => ({\n        ...prev,\n        pricing: { ...prev.pricing, shipping: Math.max(0, amount) },\n      }));\n    },\n    [updateQuote]\n  );\n\n  const setTaxRate = useCallback(\n    (rate: number) => {\n      updateQuote((prev) => ({\n        ...prev,\n        pricing: { ...prev.pricing, taxRate: Math.max(0, rate) },\n      }));\n    },\n    [updateQuote]\n  );\n\n  const setTaxType = useCallback(\n    (type: TaxType) => {\n      updateQuote((prev) => ({\n        ...prev,\n        pricing: { ...prev.pricing, taxType: type },\n      }));\n    },\n    [updateQuote]\n  );\n\n  const recalculate = useCallback(() => {\n    setQuote((prev) => recalculatePricing(prev));\n  }, [recalculatePricing]);\n\n  // Terms actions\n  const updateTerms = useCallback(\n    (terms: Partial<QuoteTerms>) => {\n      updateQuote((prev) => ({\n        ...prev,\n        terms: { ...prev.terms, ...terms },\n      }));\n    },\n    [updateQuote]\n  );\n\n  const setExpirationDate = useCallback(\n    (date: Date) => {\n      updateTerms({ expirationDate: date });\n    },\n    [updateTerms]\n  );\n\n  const setValidityDays = useCallback(\n    (days: number) => {\n      const expirationDate = new Date();\n      expirationDate.setDate(expirationDate.getDate() + days);\n      updateTerms({ validityDays: days, expirationDate });\n    },\n    [updateTerms]\n  );\n\n  // Customer actions\n  const updateCustomer = useCallback(\n    (customerUpdates: Partial<QuoteCustomer>) => {\n      updateQuote((prev) => ({\n        ...prev,\n        customer: { ...prev.customer, ...customerUpdates },\n      }));\n    },\n    [updateQuote]\n  );\n\n  // Selection actions\n  const selectItem = useCallback((itemId: string) => {\n    setSelectedItems((prev) => new Set(prev).add(itemId));\n  }, []);\n\n  const deselectItem = useCallback((itemId: string) => {\n    setSelectedItems((prev) => {\n      const newSet = new Set(prev);\n      newSet.delete(itemId);\n      return newSet;\n    });\n  }, []);\n\n  const toggleItemSelection = useCallback((itemId: string) => {\n    setSelectedItems((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(itemId)) {\n        newSet.delete(itemId);\n      } else {\n        newSet.add(itemId);\n      }\n      return newSet;\n    });\n  }, []);\n\n  const selectAllItems = useCallback(() => {\n    setSelectedItems(new Set(quote.items.map((item) => item.id)));\n  }, [quote.items]);\n\n  const deselectAllItems = useCallback(() => {\n    setSelectedItems(new Set());\n  }, []);\n\n  const removeSelectedItems = useCallback(() => {\n    updateQuote((prev) => ({\n      ...prev,\n      items: prev.items.filter((item) => !selectedItems.has(item.id)),\n    }));\n    setSelectedItems(new Set());\n  }, [selectedItems, updateQuote]);\n\n  const applyDiscountToSelected = useCallback(\n    (discount: QuoteLineItem[\"discount\"]) => {\n      if (!discount) return;\n      updateQuote((prev) => ({\n        ...prev,\n        items: prev.items.map((item) =>\n          selectedItems.has(item.id)\n            ? calculateItemTotals({ ...item, discount })\n            : item\n        ),\n      }));\n    },\n    [selectedItems, calculateItemTotals, updateQuote]\n  );\n\n  // Quote actions\n  const save = useCallback((): Quote => {\n    const savedQuote = recalculatePricing(quote);\n    setQuote(savedQuote);\n    setIsDirty(false);\n    onSave?.(savedQuote);\n    return savedQuote;\n  }, [quote, recalculatePricing, onSave]);\n\n  const send = useCallback(() => {\n    const sentQuote: Quote = {\n      ...recalculatePricing(quote),\n      status: \"sent\",\n      sentAt: new Date(),\n    };\n    setQuote(sentQuote);\n    setIsDirty(false);\n    onSend?.(sentQuote);\n  }, [quote, recalculatePricing, onSend]);\n\n  const createRevision = useCallback(() => {\n    // Create revision without the date properties (they will be omitted)\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const { sentAt, viewedAt, respondedAt, ...baseQuote } = quote;\n    const revision: Quote = {\n      ...baseQuote,\n      id: generateId(),\n      quoteNumber: generateQuoteNumber(),\n      status: \"draft\",\n      version: quote.version + 1,\n      originalQuoteId: quote.id,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n    setQuote(revision);\n    setIsDirty(true);\n  }, [quote, generateQuoteNumber]);\n\n  const reset = useCallback(() => {\n    setQuote(createInitialQuote(options, generateQuoteNumber));\n    setIsDirty(false);\n    setSelectedItems(new Set());\n  }, [options, generateQuoteNumber]);\n\n  const markDirty = useCallback(() => {\n    setIsDirty(true);\n  }, []);\n\n  const markClean = useCallback(() => {\n    setIsDirty(false);\n  }, []);\n\n  // Validation\n  const validate = useCallback(() => validateQuote(quote), [quote]);\n\n  const getItem = useCallback(\n    (itemId: string) => quote.items.find((item) => item.id === itemId),\n    [quote.items]\n  );\n\n  const hasItem = useCallback(\n    (itemId: string) => quote.items.some((item) => item.id === itemId),\n    [quote.items]\n  );\n\n  return {\n    state,\n\n    // Line item actions\n    addItem,\n    updateItem,\n    removeItem,\n    duplicateItem,\n    setItemQuantity,\n    applyItemDiscount,\n    clearItemDiscount,\n    reorderItems,\n\n    // Cart conversion\n    importFromCart,\n    replaceFromCart,\n\n    // Quote-level discount actions\n    addDiscount,\n    removeDiscount,\n    clearDiscounts,\n\n    // Pricing actions\n    setShipping,\n    setTaxRate,\n    setTaxType,\n    recalculate,\n\n    // Terms actions\n    updateTerms,\n    setExpirationDate,\n    setValidityDays,\n\n    // Customer actions\n    updateCustomer,\n\n    // Selection actions\n    selectItem,\n    deselectItem,\n    toggleItemSelection,\n    selectAllItems,\n    deselectAllItems,\n    removeSelectedItems,\n    applyDiscountToSelected,\n\n    // Quote actions\n    save,\n    send,\n    createRevision,\n    reset,\n    markDirty,\n    markClean,\n\n    // Validation\n    validate,\n    getItem,\n    hasItem,\n  };\n}\n","import { z } from \"zod\";\n\n/**\n * Employee role schema\n */\nexport const employeeRoleSchema = z.enum([\n  \"admin\",\n  \"manager\",\n  \"purchaser\",\n  \"viewer\",\n  \"approver\",\n]);\n\nexport type EmployeeRole = z.infer<typeof employeeRoleSchema>;\n\n/**\n * Employee status schema\n */\nexport const employeeStatusSchema = z.enum([\n  \"active\",\n  \"inactive\",\n  \"pending\",\n  \"suspended\",\n]);\n\nexport type EmployeeStatus = z.infer<typeof employeeStatusSchema>;\n\n/**\n * Base employee information schema\n */\nexport const employeeBaseSchema = z.object({\n  /** First name */\n  firstName: z\n    .string()\n    .min(1, \"First name is required\")\n    .max(50, \"First name must be 50 characters or less\"),\n\n  /** Last name */\n  lastName: z\n    .string()\n    .min(1, \"Last name is required\")\n    .max(50, \"Last name must be 50 characters or less\"),\n\n  /** Email address */\n  email: z.string().email(\"Invalid email address\"),\n\n  /** Phone number */\n  phone: z\n    .string()\n    .regex(\n      /^[+]?[(]?[0-9]{1,3}[)]?[-\\s.]?[(]?[0-9]{1,3}[)]?[-\\s.]?[0-9]{4,10}$/,\n      \"Invalid phone number\"\n    )\n    .optional()\n    .or(z.literal(\"\")),\n\n  /** Job title */\n  jobTitle: z.string().max(100, \"Job title must be 100 characters or less\").optional(),\n\n  /** Department */\n  department: z.string().max(100, \"Department must be 100 characters or less\").optional(),\n\n  /** Employee number/ID */\n  employeeNumber: z\n    .string()\n    .max(50, \"Employee number must be 50 characters or less\")\n    .optional(),\n});\n\n/**\n * Employee permissions schema\n */\nexport const employeePermissionsSchema = z.object({\n  /** Can create orders */\n  canCreateOrders: z.boolean().default(false),\n\n  /** Can approve orders */\n  canApproveOrders: z.boolean().default(false),\n\n  /** Maximum order amount they can approve (without further approval) */\n  maxApprovalAmount: z.number().min(0, \"Amount must be positive\").optional(),\n\n  /** Can manage employees */\n  canManageEmployees: z.boolean().default(false),\n\n  /** Can view all orders */\n  canViewAllOrders: z.boolean().default(false),\n\n  /** Can manage company settings */\n  canManageSettings: z.boolean().default(false),\n\n  /** Can export data */\n  canExportData: z.boolean().default(false),\n\n  /** Can create quotes */\n  canCreateQuotes: z.boolean().default(false),\n\n  /** Allowed product categories (empty = all) */\n  allowedCategories: z.array(z.string()).default([]),\n\n  /** Allowed cost centers */\n  allowedCostCenters: z.array(z.string()).default([]),\n});\n\nexport type EmployeePermissions = z.infer<typeof employeePermissionsSchema>;\n\n/**\n * Employee spending limit schema\n */\nexport const employeeSpendingLimitSchema = z.object({\n  /** Monthly spending limit */\n  monthlyLimit: z.number().min(0, \"Limit must be positive\").optional(),\n\n  /** Single order limit */\n  orderLimit: z.number().min(0, \"Limit must be positive\").optional(),\n\n  /** Whether to require approval above limit */\n  requireApprovalAboveLimit: z.boolean().default(true),\n\n  /** Reporting manager ID for approvals */\n  managerId: z.string().optional(),\n\n  /** Custom approval chain */\n  approvalChain: z.array(z.string()).default([]),\n});\n\nexport type EmployeeSpendingLimit = z.infer<typeof employeeSpendingLimitSchema>;\n\n/**\n * Complete employee create schema\n */\nexport const employeeCreateSchema = employeeBaseSchema.extend({\n  /** Employee role */\n  role: employeeRoleSchema,\n\n  /** Permissions */\n  permissions: employeePermissionsSchema.optional(),\n\n  /** Spending limits */\n  spendingLimits: employeeSpendingLimitSchema.optional(),\n\n  /** Send welcome email */\n  sendWelcomeEmail: z.boolean().default(true),\n\n  /** Notes */\n  notes: z.string().max(1000, \"Notes must be 1000 characters or less\").optional(),\n});\n\nexport type EmployeeCreateInput = z.infer<typeof employeeCreateSchema>;\n\n/**\n * Employee update schema (all fields optional)\n */\nexport const employeeUpdateSchema = employeeBaseSchema.partial().extend({\n  /** Employee role */\n  role: employeeRoleSchema.optional(),\n\n  /** Employee status */\n  status: employeeStatusSchema.optional(),\n\n  /** Permissions */\n  permissions: employeePermissionsSchema.partial().optional(),\n\n  /** Spending limits */\n  spendingLimits: employeeSpendingLimitSchema.partial().optional(),\n\n  /** Notes */\n  notes: z.string().max(1000, \"Notes must be 1000 characters or less\").optional(),\n});\n\nexport type EmployeeUpdateInput = z.infer<typeof employeeUpdateSchema>;\n\n/**\n * Bulk employee import schema (for CSV imports)\n */\nexport const employeeBulkImportRowSchema = z.object({\n  firstName: z.string().min(1),\n  lastName: z.string().min(1),\n  email: z.string().email(),\n  phone: z.string().optional(),\n  role: employeeRoleSchema.default(\"viewer\"),\n  department: z.string().optional(),\n  jobTitle: z.string().optional(),\n  employeeNumber: z.string().optional(),\n  monthlyLimit: z.coerce.number().optional(),\n  orderLimit: z.coerce.number().optional(),\n  managerId: z.string().optional(),\n});\n\nexport type EmployeeBulkImportRow = z.infer<typeof employeeBulkImportRowSchema>;\n\n/**\n * Employee invite schema\n */\nexport const employeeInviteSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  role: employeeRoleSchema,\n  permissions: employeePermissionsSchema.optional(),\n  message: z.string().max(500, \"Message must be 500 characters or less\").optional(),\n  expiresIn: z.number().min(1).max(30).default(7), // days\n});\n\nexport type EmployeeInviteInput = z.infer<typeof employeeInviteSchema>;\n\n/**\n * Employee search/filter schema\n */\nexport const employeeFilterSchema = z.object({\n  search: z.string().optional(),\n  role: employeeRoleSchema.optional(),\n  status: employeeStatusSchema.optional(),\n  department: z.string().optional(),\n  hasSpendingLimit: z.boolean().optional(),\n  managerId: z.string().optional(),\n});\n\nexport type EmployeeFilter = z.infer<typeof employeeFilterSchema>;\n","import { z } from \"zod\";\n\n/**\n * Quote status schema\n */\nexport const quoteStatusSchema = z.enum([\n  \"draft\",\n  \"pending_review\",\n  \"sent\",\n  \"viewed\",\n  \"accepted\",\n  \"rejected\",\n  \"expired\",\n  \"cancelled\",\n]);\n\nexport type QuoteStatus = z.infer<typeof quoteStatusSchema>;\n\n/**\n * Discount type schema\n */\nexport const discountTypeSchema = z.enum([\"percentage\", \"fixed\", \"per_unit\"]);\n\nexport type DiscountType = z.infer<typeof discountTypeSchema>;\n\n/**\n * Tax type schema\n */\nexport const taxTypeSchema = z.enum([\"included\", \"excluded\", \"exempt\"]);\n\nexport type TaxType = z.infer<typeof taxTypeSchema>;\n\n/**\n * Address schema\n */\nexport const addressSchema = z.object({\n  line1: z.string().min(1, \"Address line 1 is required\").max(200),\n  line2: z.string().max(200).optional(),\n  city: z.string().min(1, \"City is required\").max(100),\n  state: z.string().max(100).optional(),\n  postalCode: z.string().min(1, \"Postal code is required\").max(20),\n  country: z.string().min(2, \"Country is required\").max(2),\n});\n\nexport type AddressInput = z.infer<typeof addressSchema>;\n\n/**\n * Quote customer schema\n */\nexport const quoteCustomerSchema = z.object({\n  companyName: z\n    .string()\n    .min(1, \"Company name is required\")\n    .max(200, \"Company name must be 200 characters or less\"),\n\n  contactName: z\n    .string()\n    .min(1, \"Contact name is required\")\n    .max(100, \"Contact name must be 100 characters or less\"),\n\n  email: z.string().email(\"Invalid email address\"),\n\n  phone: z\n    .string()\n    .max(30, \"Phone must be 30 characters or less\")\n    .optional()\n    .or(z.literal(\"\")),\n\n  billingAddress: addressSchema.optional(),\n\n  shippingAddress: addressSchema.optional(),\n\n  taxId: z.string().max(50, \"Tax ID must be 50 characters or less\").optional(),\n\n  paymentTerms: z.string().max(50).optional(),\n});\n\nexport type QuoteCustomerInput = z.infer<typeof quoteCustomerSchema>;\n\n/**\n * Quote line item discount schema\n */\nexport const lineItemDiscountSchema = z.object({\n  type: discountTypeSchema,\n  value: z.number().min(0, \"Discount value must be positive\"),\n  reason: z.string().max(200).optional(),\n});\n\nexport type LineItemDiscountInput = z.infer<typeof lineItemDiscountSchema>;\n\n/**\n * Quote line item schema\n */\nexport const quoteLineItemSchema = z.object({\n  productId: z.string().min(1, \"Product ID is required\"),\n\n  name: z\n    .string()\n    .min(1, \"Product name is required\")\n    .max(200, \"Product name must be 200 characters or less\"),\n\n  description: z.string().max(1000).optional(),\n\n  sku: z.string().max(50).optional(),\n\n  quantity: z\n    .number()\n    .int(\"Quantity must be a whole number\")\n    .min(1, \"Quantity must be at least 1\"),\n\n  unit: z.string().max(20).optional(),\n\n  unitPrice: z.number().min(0, \"Unit price must be positive\"),\n\n  discount: lineItemDiscountSchema.optional(),\n\n  taxRate: z.number().min(0).max(100).optional(),\n\n  customOptions: z.record(z.unknown()).optional(),\n\n  leadTime: z.number().int().min(0).optional(),\n\n  notes: z.string().max(500).optional(),\n});\n\nexport type QuoteLineItemInput = z.infer<typeof quoteLineItemSchema>;\n\n/**\n * Quote-level discount schema\n */\nexport const quoteDiscountSchema = z.object({\n  type: discountTypeSchema,\n  value: z.number().min(0, \"Discount value must be positive\"),\n  code: z.string().max(50).optional(),\n  reason: z.string().max(200).optional(),\n  minOrderValue: z.number().min(0).optional(),\n  maxDiscount: z.number().min(0).optional(),\n});\n\nexport type QuoteDiscountInput = z.infer<typeof quoteDiscountSchema>;\n\n/**\n * Quote terms schema\n */\nexport const quoteTermsSchema = z.object({\n  paymentTerms: z\n    .string()\n    .min(1, \"Payment terms are required\")\n    .max(50, \"Payment terms must be 50 characters or less\"),\n\n  paymentDueDate: z.coerce.date().optional(),\n\n  deliveryTerms: z.string().max(50).optional(),\n\n  deliveryDate: z.coerce.date().optional(),\n\n  validityDays: z\n    .number()\n    .int(\"Validity must be a whole number\")\n    .min(1, \"Validity must be at least 1 day\")\n    .max(365, \"Validity cannot exceed 365 days\"),\n\n  customTerms: z.string().max(5000, \"Custom terms must be 5000 characters or less\").optional(),\n\n  notes: z.string().max(2000, \"Notes must be 2000 characters or less\").optional(),\n\n  internalNotes: z\n    .string()\n    .max(2000, \"Internal notes must be 2000 characters or less\")\n    .optional(),\n});\n\nexport type QuoteTermsInput = z.infer<typeof quoteTermsSchema>;\n\n/**\n * Quote pricing schema\n */\nexport const quotePricingSchema = z.object({\n  shipping: z.number().min(0, \"Shipping must be positive\"),\n  taxType: taxTypeSchema,\n  taxRate: z.number().min(0, \"Tax rate must be positive\").max(100, \"Tax rate cannot exceed 100%\"),\n  currency: z.string().length(3, \"Currency must be a 3-letter code\"),\n});\n\nexport type QuotePricingInput = z.infer<typeof quotePricingSchema>;\n\n/**\n * Complete quote create schema\n */\nexport const quoteCreateSchema = z.object({\n  customer: quoteCustomerSchema,\n\n  items: z\n    .array(quoteLineItemSchema)\n    .min(1, \"Quote must have at least one item\"),\n\n  discounts: z.array(quoteDiscountSchema).default([]),\n\n  pricing: quotePricingSchema,\n\n  terms: quoteTermsSchema,\n\n  metadata: z.record(z.unknown()).optional(),\n});\n\nexport type QuoteCreateInput = z.infer<typeof quoteCreateSchema>;\n\n/**\n * Quote update schema\n */\nexport const quoteUpdateSchema = z.object({\n  customer: quoteCustomerSchema.partial().optional(),\n\n  items: z.array(quoteLineItemSchema).optional(),\n\n  discounts: z.array(quoteDiscountSchema).optional(),\n\n  pricing: quotePricingSchema.partial().optional(),\n\n  terms: quoteTermsSchema.partial().optional(),\n\n  status: quoteStatusSchema.optional(),\n\n  metadata: z.record(z.unknown()).optional(),\n});\n\nexport type QuoteUpdateInput = z.infer<typeof quoteUpdateSchema>;\n\n/**\n * Quote send schema\n */\nexport const quoteSendSchema = z.object({\n  recipientEmail: z.string().email(\"Invalid recipient email\"),\n  ccEmails: z.array(z.string().email()).default([]),\n  subject: z.string().min(1, \"Subject is required\").max(200),\n  message: z.string().max(5000).optional(),\n  attachPdf: z.boolean().default(true),\n});\n\nexport type QuoteSendInput = z.infer<typeof quoteSendSchema>;\n\n/**\n * Quote response schema (accept/reject)\n */\nexport const quoteResponseSchema = z.object({\n  action: z.enum([\"accept\", \"reject\", \"request_revision\"]),\n  comment: z.string().max(2000).optional(),\n  purchaseOrderNumber: z.string().max(50).optional(),\n});\n\nexport type QuoteResponseInput = z.infer<typeof quoteResponseSchema>;\n\n/**\n * Quote filter schema\n */\nexport const quoteFilterSchema = z.object({\n  search: z.string().optional(),\n  status: quoteStatusSchema.optional(),\n  customerId: z.string().optional(),\n  createdBy: z.string().optional(),\n  dateFrom: z.coerce.date().optional(),\n  dateTo: z.coerce.date().optional(),\n  minTotal: z.number().optional(),\n  maxTotal: z.number().optional(),\n});\n\nexport type QuoteFilter = z.infer<typeof quoteFilterSchema>;\n","import { z } from \"zod\";\n\n/**\n * Company type schema\n */\nexport const companyTypeSchema = z.enum([\n  \"retailer\",\n  \"wholesaler\",\n  \"distributor\",\n  \"manufacturer\",\n  \"other\",\n]);\n\nexport type CompanyType = z.infer<typeof companyTypeSchema>;\n\n/**\n * Company status schema\n */\nexport const companyStatusSchema = z.enum([\n  \"active\",\n  \"pending_approval\",\n  \"suspended\",\n  \"inactive\",\n]);\n\nexport type CompanyStatus = z.infer<typeof companyStatusSchema>;\n\n/**\n * Address schema\n */\nexport const companyAddressSchema = z.object({\n  line1: z.string().min(1, \"Address line 1 is required\").max(200),\n  line2: z.string().max(200).optional(),\n  city: z.string().min(1, \"City is required\").max(100),\n  state: z.string().max(100).optional(),\n  postalCode: z.string().min(1, \"Postal code is required\").max(20),\n  country: z\n    .string()\n    .min(2, \"Country code must be 2 characters\")\n    .max(2, \"Country code must be 2 characters\"),\n  isDefault: z.boolean().default(false),\n  label: z.string().max(50).optional(),\n});\n\nexport type CompanyAddressInput = z.infer<typeof companyAddressSchema>;\n\n/**\n * Company billing settings schema\n */\nexport const companyBillingSettingsSchema = z.object({\n  /** Payment terms (e.g., 'NET30', 'NET60') */\n  paymentTerms: z.string().min(1, \"Payment terms are required\").max(50),\n\n  /** Credit limit */\n  creditLimit: z.number().min(0, \"Credit limit must be positive\").optional(),\n\n  /** Whether to auto-approve orders under credit limit */\n  autoApproveUnderCreditLimit: z.boolean().default(false),\n\n  /** Tax exemption status */\n  taxExempt: z.boolean().default(false),\n\n  /** Tax exemption certificate number */\n  taxExemptionCertificate: z.string().max(100).optional(),\n\n  /** Preferred currency */\n  preferredCurrency: z.string().length(3, \"Currency must be a 3-letter code\").default(\"EUR\"),\n\n  /** Default billing address ID */\n  defaultBillingAddressId: z.string().optional(),\n\n  /** Invoice email */\n  invoiceEmail: z.string().email(\"Invalid invoice email\").optional(),\n\n  /** PO required for orders */\n  requirePurchaseOrder: z.boolean().default(false),\n});\n\nexport type CompanyBillingSettingsInput = z.infer<typeof companyBillingSettingsSchema>;\n\n/**\n * Company shipping settings schema\n */\nexport const companyShippingSettingsSchema = z.object({\n  /** Default shipping address ID */\n  defaultShippingAddressId: z.string().optional(),\n\n  /** Preferred shipping method */\n  preferredShippingMethod: z.string().max(50).optional(),\n\n  /** Shipping account number (for carrier accounts) */\n  shippingAccountNumber: z.string().max(50).optional(),\n\n  /** Special shipping instructions */\n  shippingInstructions: z.string().max(500).optional(),\n\n  /** Allow partial shipments */\n  allowPartialShipments: z.boolean().default(true),\n\n  /** Consolidate shipments */\n  consolidateShipments: z.boolean().default(false),\n});\n\nexport type CompanyShippingSettingsInput = z.infer<typeof companyShippingSettingsSchema>;\n\n/**\n * Company ordering settings schema\n */\nexport const companyOrderingSettingsSchema = z.object({\n  /** Minimum order value */\n  minimumOrderValue: z.number().min(0, \"Minimum order must be positive\").optional(),\n\n  /** Maximum order value */\n  maximumOrderValue: z.number().min(0, \"Maximum order must be positive\").optional(),\n\n  /** Require approval for orders over amount */\n  approvalThreshold: z.number().min(0).optional(),\n\n  /** Allowed product categories (empty = all) */\n  allowedCategories: z.array(z.string()).default([]),\n\n  /** Blocked product categories */\n  blockedCategories: z.array(z.string()).default([]),\n\n  /** Enable bulk ordering */\n  enableBulkOrdering: z.boolean().default(true),\n\n  /** Enable quick reorder */\n  enableQuickReorder: z.boolean().default(true),\n\n  /** Default cost center */\n  defaultCostCenter: z.string().max(50).optional(),\n});\n\nexport type CompanyOrderingSettingsInput = z.infer<typeof companyOrderingSettingsSchema>;\n\n/**\n * Company notification settings schema\n */\nexport const companyNotificationSettingsSchema = z.object({\n  /** Order confirmation emails */\n  orderConfirmation: z.boolean().default(true),\n\n  /** Shipping notification emails */\n  shippingNotification: z.boolean().default(true),\n\n  /** Invoice emails */\n  invoiceNotification: z.boolean().default(true),\n\n  /** Quote emails */\n  quoteNotification: z.boolean().default(true),\n\n  /** Spending alert emails */\n  spendingAlerts: z.boolean().default(true),\n\n  /** Weekly spending summary */\n  weeklySpendingSummary: z.boolean().default(false),\n\n  /** Monthly spending summary */\n  monthlySpendingSummary: z.boolean().default(true),\n\n  /** Additional notification emails */\n  additionalEmails: z.array(z.string().email()).default([]),\n});\n\nexport type CompanyNotificationSettingsInput = z.infer<typeof companyNotificationSettingsSchema>;\n\n/**\n * Company branding settings schema\n */\nexport const companyBrandingSettingsSchema = z.object({\n  /** Company logo URL */\n  logoUrl: z.string().url(\"Invalid logo URL\").optional(),\n\n  /** Primary brand color */\n  primaryColor: z\n    .string()\n    .regex(/^#[0-9A-Fa-f]{6}$/, \"Invalid color format\")\n    .optional(),\n\n  /** Custom CSS class prefix */\n  cssPrefix: z.string().max(20).optional(),\n\n  /** Custom footer text */\n  footerText: z.string().max(500).optional(),\n});\n\nexport type CompanyBrandingSettingsInput = z.infer<typeof companyBrandingSettingsSchema>;\n\n/**\n * Complete company profile schema\n */\nexport const companyProfileSchema = z.object({\n  /** Company legal name */\n  legalName: z\n    .string()\n    .min(1, \"Legal name is required\")\n    .max(200, \"Legal name must be 200 characters or less\"),\n\n  /** Trading/display name */\n  tradingName: z.string().max(200).optional(),\n\n  /** Company type */\n  type: companyTypeSchema,\n\n  /** Tax ID / VAT number */\n  taxId: z\n    .string()\n    .min(1, \"Tax ID is required\")\n    .max(50, \"Tax ID must be 50 characters or less\"),\n\n  /** Registration number */\n  registrationNumber: z.string().max(50).optional(),\n\n  /** Company website */\n  website: z.string().url(\"Invalid website URL\").optional().or(z.literal(\"\")),\n\n  /** Company phone */\n  phone: z.string().max(30).optional(),\n\n  /** Company email */\n  email: z.string().email(\"Invalid email address\"),\n\n  /** Industry/sector */\n  industry: z.string().max(100).optional(),\n\n  /** Company description */\n  description: z.string().max(2000).optional(),\n\n  /** Year established */\n  yearEstablished: z\n    .number()\n    .int()\n    .min(1800)\n    .max(new Date().getFullYear())\n    .optional(),\n\n  /** Number of employees */\n  employeeCount: z.number().int().min(1).optional(),\n\n  /** Annual revenue range */\n  revenueRange: z.string().max(50).optional(),\n});\n\nexport type CompanyProfileInput = z.infer<typeof companyProfileSchema>;\n\n/**\n * Complete company settings schema\n */\nexport const companySettingsSchema = z.object({\n  profile: companyProfileSchema,\n  addresses: z.array(companyAddressSchema).default([]),\n  billing: companyBillingSettingsSchema,\n  shipping: companyShippingSettingsSchema,\n  ordering: companyOrderingSettingsSchema,\n  notifications: companyNotificationSettingsSchema,\n  branding: companyBrandingSettingsSchema.optional(),\n});\n\nexport type CompanySettingsInput = z.infer<typeof companySettingsSchema>;\n\n/**\n * Company registration schema (for new companies)\n */\nexport const companyRegistrationSchema = z.object({\n  profile: companyProfileSchema,\n  primaryAddress: companyAddressSchema,\n  primaryContact: z.object({\n    firstName: z.string().min(1, \"First name is required\").max(50),\n    lastName: z.string().min(1, \"Last name is required\").max(50),\n    email: z.string().email(\"Invalid email address\"),\n    phone: z.string().max(30).optional(),\n    jobTitle: z.string().max(100).optional(),\n  }),\n  billing: companyBillingSettingsSchema.pick({\n    paymentTerms: true,\n    preferredCurrency: true,\n    invoiceEmail: true,\n  }),\n  acceptTerms: z.literal(true, {\n    errorMap: () => ({ message: \"You must accept the terms and conditions\" }),\n  }),\n});\n\nexport type CompanyRegistrationInput = z.infer<typeof companyRegistrationSchema>;\n\n/**\n * Company filter schema\n */\nexport const companyFilterSchema = z.object({\n  search: z.string().optional(),\n  type: companyTypeSchema.optional(),\n  status: companyStatusSchema.optional(),\n  country: z.string().optional(),\n  hasCredit: z.boolean().optional(),\n  minCreditLimit: z.number().optional(),\n  maxCreditLimit: z.number().optional(),\n});\n\nexport type CompanyFilter = z.infer<typeof companyFilterSchema>;\n","import { z } from \"zod\";\n\n/**\n * Spending period schema\n */\nexport const spendingPeriodSchema = z.enum([\n  \"daily\",\n  \"weekly\",\n  \"monthly\",\n  \"quarterly\",\n  \"yearly\",\n  \"custom\",\n]);\n\nexport type SpendingPeriod = z.infer<typeof spendingPeriodSchema>;\n\n/**\n * Spending limit type schema\n */\nexport const spendingLimitTypeSchema = z.enum([\n  \"employee\",\n  \"department\",\n  \"cost_center\",\n  \"company\",\n  \"category\",\n]);\n\nexport type SpendingLimitType = z.infer<typeof spendingLimitTypeSchema>;\n\n/**\n * Spending limit status schema\n */\nexport const spendingLimitStatusSchema = z.enum([\n  \"active\",\n  \"paused\",\n  \"expired\",\n  \"exceeded\",\n]);\n\nexport type SpendingLimitStatus = z.infer<typeof spendingLimitStatusSchema>;\n\n/**\n * Threshold action schema\n */\nexport const thresholdActionSchema = z.enum([\n  \"notify\",\n  \"notify_manager\",\n  \"require_approval\",\n  \"block\",\n]);\n\nexport type ThresholdAction = z.infer<typeof thresholdActionSchema>;\n\n/**\n * Spending threshold schema\n */\nexport const spendingThresholdSchema = z.object({\n  /** Percentage at which this threshold triggers (0-100) */\n  percentage: z\n    .number()\n    .min(0, \"Percentage must be at least 0\")\n    .max(100, \"Percentage cannot exceed 100\"),\n\n  /** Action to take when threshold is reached */\n  action: thresholdActionSchema,\n\n  /** Custom message for notifications */\n  notificationMessage: z.string().max(500).optional(),\n\n  /** Whether threshold is active */\n  isActive: z.boolean().default(true),\n});\n\nexport type SpendingThresholdInput = z.infer<typeof spendingThresholdSchema>;\n\n/**\n * Currency config schema\n */\nexport const currencyConfigSchema = z.object({\n  code: z.string().length(3, \"Currency code must be 3 characters\"),\n  symbol: z.string().min(1).max(5),\n  decimals: z.number().int().min(0).max(4).default(2),\n  symbolPosition: z.enum([\"before\", \"after\"]).default(\"before\"),\n  thousandsSeparator: z.string().max(1).default(\",\"),\n  decimalSeparator: z.string().max(1).default(\".\"),\n});\n\nexport type CurrencyConfigInput = z.infer<typeof currencyConfigSchema>;\n\n/**\n * Base spending limit schema\n */\nexport const spendingLimitBaseSchema = z.object({\n  /** Limit name */\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(100, \"Name must be 100 characters or less\"),\n\n  /** Description */\n  description: z.string().max(500).optional(),\n\n  /** Limit type */\n  type: spendingLimitTypeSchema,\n\n  /** Maximum spending amount */\n  maxAmount: z\n    .number()\n    .positive(\"Maximum amount must be positive\")\n    .max(999999999, \"Maximum amount is too large\"),\n\n  /** Spending period */\n  period: spendingPeriodSchema,\n\n  /** Currency */\n  currency: currencyConfigSchema.optional(),\n\n  /** Whether limit is active */\n  isActive: z.boolean().default(true),\n\n  /** Whether to allow exceeding the limit */\n  allowExceed: z.boolean().default(false),\n\n  /** Soft limit (warning threshold) */\n  softLimit: z\n    .number()\n    .positive(\"Soft limit must be positive\")\n    .optional(),\n\n  /** Hard limit (absolute maximum) */\n  hardLimit: z\n    .number()\n    .positive(\"Hard limit must be positive\")\n    .optional(),\n});\n\n/**\n * Employee spending limit schema\n */\nexport const employeeSpendingLimitCreateSchema = spendingLimitBaseSchema.extend({\n  type: z.literal(\"employee\"),\n\n  /** Employee ID */\n  employeeId: z.string().min(1, \"Employee ID is required\"),\n\n  /** Per-order limit */\n  orderLimit: z.number().positive().optional(),\n\n  /** Require approval above amount */\n  approvalThreshold: z.number().positive().optional(),\n\n  /** Manager ID for approvals */\n  managerId: z.string().optional(),\n\n  /** Custom thresholds */\n  thresholds: z.array(spendingThresholdSchema).default([]),\n});\n\nexport type EmployeeSpendingLimitCreateInput = z.infer<typeof employeeSpendingLimitCreateSchema>;\n\n/**\n * Department spending limit schema\n */\nexport const departmentSpendingLimitCreateSchema = spendingLimitBaseSchema.extend({\n  type: z.literal(\"department\"),\n\n  /** Department ID */\n  departmentId: z.string().min(1, \"Department ID is required\"),\n\n  /** Department name */\n  departmentName: z.string().min(1).max(100),\n\n  /** Whether to distribute across employees */\n  distributeToEmployees: z.boolean().default(false),\n\n  /** Per-employee limit when distributed */\n  perEmployeeLimit: z.number().positive().optional(),\n\n  /** Approval chain */\n  approvalChain: z.array(z.string()).default([]),\n\n  /** Custom thresholds */\n  thresholds: z.array(spendingThresholdSchema).default([]),\n});\n\nexport type DepartmentSpendingLimitCreateInput = z.infer<typeof departmentSpendingLimitCreateSchema>;\n\n/**\n * Cost center spending limit schema\n */\nexport const costCenterSpendingLimitCreateSchema = spendingLimitBaseSchema.extend({\n  type: z.literal(\"cost_center\"),\n\n  /** Cost center code */\n  costCenterCode: z.string().min(1, \"Cost center code is required\").max(50),\n\n  /** Cost center name */\n  costCenterName: z.string().min(1).max(100),\n\n  /** Account code */\n  accountCode: z.string().max(50).optional(),\n\n  /** GL code */\n  glCode: z.string().max(50).optional(),\n\n  /** Approval chain */\n  approvalChain: z.array(z.string()).default([]),\n\n  /** Custom thresholds */\n  thresholds: z.array(spendingThresholdSchema).default([]),\n});\n\nexport type CostCenterSpendingLimitCreateInput = z.infer<typeof costCenterSpendingLimitCreateSchema>;\n\n/**\n * Category spending limit schema\n */\nexport const categorySpendingLimitCreateSchema = spendingLimitBaseSchema.extend({\n  type: z.literal(\"category\"),\n\n  /** Category ID */\n  categoryId: z.string().min(1, \"Category ID is required\"),\n\n  /** Category name */\n  categoryName: z.string().min(1).max(100),\n\n  /** Include subcategories */\n  includeSubcategories: z.boolean().default(true),\n\n  /** Custom thresholds */\n  thresholds: z.array(spendingThresholdSchema).default([]),\n});\n\nexport type CategorySpendingLimitCreateInput = z.infer<typeof categorySpendingLimitCreateSchema>;\n\n/**\n * Company-wide spending limit schema\n */\nexport const companySpendingLimitCreateSchema = spendingLimitBaseSchema.extend({\n  type: z.literal(\"company\"),\n\n  /** Company ID */\n  companyId: z.string().min(1, \"Company ID is required\"),\n\n  /** Whether this is a global cap */\n  isGlobalCap: z.boolean().default(true),\n\n  /** Custom thresholds */\n  thresholds: z.array(spendingThresholdSchema).default([]),\n});\n\nexport type CompanySpendingLimitCreateInput = z.infer<typeof companySpendingLimitCreateSchema>;\n\n/**\n * Union of all spending limit create schemas\n */\nexport const spendingLimitCreateSchema = z.discriminatedUnion(\"type\", [\n  employeeSpendingLimitCreateSchema,\n  departmentSpendingLimitCreateSchema,\n  costCenterSpendingLimitCreateSchema,\n  categorySpendingLimitCreateSchema,\n  companySpendingLimitCreateSchema,\n]);\n\nexport type SpendingLimitCreateInput = z.infer<typeof spendingLimitCreateSchema>;\n\n/**\n * Spending limit update schema\n */\nexport const spendingLimitUpdateSchema = spendingLimitBaseSchema.partial().extend({\n  /** Custom thresholds */\n  thresholds: z.array(spendingThresholdSchema).optional(),\n});\n\nexport type SpendingLimitUpdateInput = z.infer<typeof spendingLimitUpdateSchema>;\n\n/**\n * Spending limit filter schema\n */\nexport const spendingLimitFilterSchema = z.object({\n  search: z.string().optional(),\n  type: spendingLimitTypeSchema.optional(),\n  status: spendingLimitStatusSchema.optional(),\n  period: spendingPeriodSchema.optional(),\n  employeeId: z.string().optional(),\n  departmentId: z.string().optional(),\n  isActive: z.boolean().optional(),\n  isExceeded: z.boolean().optional(),\n});\n\nexport type SpendingLimitFilter = z.infer<typeof spendingLimitFilterSchema>;\n\n/**\n * Spending transaction schema (for tracking)\n */\nexport const spendingTransactionSchema = z.object({\n  /** Transaction amount */\n  amount: z.number().positive(\"Amount must be positive\"),\n\n  /** Transaction description */\n  description: z.string().max(500).optional(),\n\n  /** Reference (order ID, etc.) */\n  reference: z.string().max(100).optional(),\n\n  /** Transaction date */\n  transactionDate: z.coerce.date().default(() => new Date()),\n\n  /** Category */\n  category: z.string().optional(),\n\n  /** Cost center */\n  costCenter: z.string().optional(),\n});\n\nexport type SpendingTransactionInput = z.infer<typeof spendingTransactionSchema>;\n\n/**\n * Spending adjustment schema (for corrections)\n */\nexport const spendingAdjustmentSchema = z.object({\n  /** Adjustment amount (positive to increase, negative to decrease) */\n  amount: z.number(),\n\n  /** Reason for adjustment */\n  reason: z.string().min(1, \"Reason is required\").max(500),\n\n  /** Reference (order ID, refund ID, etc.) */\n  reference: z.string().max(100).optional(),\n\n  /** Approved by */\n  approvedBy: z.string().min(1, \"Approver is required\"),\n});\n\nexport type SpendingAdjustmentInput = z.infer<typeof spendingAdjustmentSchema>;\n","/**\n * Approval Rules Utilities\n *\n * Functions for evaluating approval rules in B2B workflows.\n */\n\n/**\n * Approval rule condition type\n */\nexport type RuleConditionType =\n  | \"amount_greater_than\"\n  | \"amount_less_than\"\n  | \"amount_between\"\n  | \"quantity_greater_than\"\n  | \"quantity_less_than\"\n  | \"category_in\"\n  | \"category_not_in\"\n  | \"user_role_in\"\n  | \"user_role_not_in\"\n  | \"department_in\"\n  | \"department_not_in\"\n  | \"cost_center_in\"\n  | \"cost_center_not_in\"\n  | \"vendor_in\"\n  | \"vendor_not_in\"\n  | \"custom\";\n\n/**\n * Approval rule condition\n */\nexport interface RuleCondition {\n  type: RuleConditionType;\n  value: unknown;\n  valueTo?: unknown; // For 'between' conditions\n}\n\n/**\n * Approval rule action\n */\nexport type RuleActionType =\n  | \"auto_approve\"\n  | \"require_approval\"\n  | \"require_multi_approval\"\n  | \"escalate\"\n  | \"reject\"\n  | \"notify\";\n\n/**\n * Approval rule action configuration\n */\nexport interface RuleAction {\n  type: RuleActionType;\n  /** Approver IDs (for require_approval) */\n  approverIds?: string[];\n  /** Number of approvals required (for multi_approval) */\n  requiredApprovals?: number;\n  /** Escalation target ID */\n  escalateTo?: string;\n  /** Notification message */\n  message?: string;\n  /** Notification recipients */\n  notifyRecipients?: string[];\n}\n\n/**\n * Complete approval rule\n */\nexport interface ApprovalRule {\n  id: string;\n  name: string;\n  description?: string;\n  /** Conditions that must all be met (AND logic) */\n  conditions: RuleCondition[];\n  /** Action to take when rule matches */\n  action: RuleAction;\n  /** Rule priority (lower = higher priority) */\n  priority: number;\n  /** Whether rule is active */\n  isActive: boolean;\n}\n\n/**\n * Context for rule evaluation\n */\nexport interface RuleEvaluationContext {\n  /** Order/request amount */\n  amount?: number;\n  /** Total quantity */\n  quantity?: number;\n  /** Item categories */\n  categories?: string[];\n  /** User role */\n  userRole?: string;\n  /** User department */\n  department?: string;\n  /** Cost center */\n  costCenter?: string;\n  /** Vendor/supplier ID */\n  vendorId?: string;\n  /** Custom data for custom conditions */\n  customData?: Record<string, unknown>;\n}\n\n/**\n * Rule evaluation result\n */\nexport interface RuleEvaluationResult {\n  /** Whether any rule matched */\n  matched: boolean;\n  /** Matching rule (if any) */\n  matchedRule?: ApprovalRule;\n  /** Action to take */\n  action?: RuleAction;\n  /** All evaluated rules with their match status */\n  evaluations: Array<{\n    rule: ApprovalRule;\n    matched: boolean;\n    failedConditions: RuleCondition[];\n  }>;\n}\n\n/**\n * Evaluate a single condition against context\n */\nexport function evaluateCondition(\n  condition: RuleCondition,\n  context: RuleEvaluationContext\n): boolean {\n  switch (condition.type) {\n    case \"amount_greater_than\":\n      return (\n        context.amount !== undefined &&\n        context.amount > (condition.value as number)\n      );\n\n    case \"amount_less_than\":\n      return (\n        context.amount !== undefined &&\n        context.amount < (condition.value as number)\n      );\n\n    case \"amount_between\":\n      return (\n        context.amount !== undefined &&\n        context.amount >= (condition.value as number) &&\n        context.amount <= (condition.valueTo as number)\n      );\n\n    case \"quantity_greater_than\":\n      return (\n        context.quantity !== undefined &&\n        context.quantity > (condition.value as number)\n      );\n\n    case \"quantity_less_than\":\n      return (\n        context.quantity !== undefined &&\n        context.quantity < (condition.value as number)\n      );\n\n    case \"category_in\":\n      return (\n        context.categories !== undefined &&\n        (condition.value as string[]).some((cat) =>\n          context.categories!.includes(cat)\n        )\n      );\n\n    case \"category_not_in\":\n      return (\n        context.categories !== undefined &&\n        !(condition.value as string[]).some((cat) =>\n          context.categories!.includes(cat)\n        )\n      );\n\n    case \"user_role_in\":\n      return (\n        context.userRole !== undefined &&\n        (condition.value as string[]).includes(context.userRole)\n      );\n\n    case \"user_role_not_in\":\n      return (\n        context.userRole !== undefined &&\n        !(condition.value as string[]).includes(context.userRole)\n      );\n\n    case \"department_in\":\n      return (\n        context.department !== undefined &&\n        (condition.value as string[]).includes(context.department)\n      );\n\n    case \"department_not_in\":\n      return (\n        context.department !== undefined &&\n        !(condition.value as string[]).includes(context.department)\n      );\n\n    case \"cost_center_in\":\n      return (\n        context.costCenter !== undefined &&\n        (condition.value as string[]).includes(context.costCenter)\n      );\n\n    case \"cost_center_not_in\":\n      return (\n        context.costCenter !== undefined &&\n        !(condition.value as string[]).includes(context.costCenter)\n      );\n\n    case \"vendor_in\":\n      return (\n        context.vendorId !== undefined &&\n        (condition.value as string[]).includes(context.vendorId)\n      );\n\n    case \"vendor_not_in\":\n      return (\n        context.vendorId !== undefined &&\n        !(condition.value as string[]).includes(context.vendorId)\n      );\n\n    case \"custom\":\n      // Custom conditions require a custom evaluator\n      // The value should be a function or key to look up in customData\n      if (typeof condition.value === \"function\") {\n        return (condition.value as (ctx: RuleEvaluationContext) => boolean)(\n          context\n        );\n      }\n      return false;\n\n    default:\n      return false;\n  }\n}\n\n/**\n * Evaluate a single rule against context\n */\nexport function evaluateRule(\n  rule: ApprovalRule,\n  context: RuleEvaluationContext\n): { matched: boolean; failedConditions: RuleCondition[] } {\n  if (!rule.isActive) {\n    return { matched: false, failedConditions: rule.conditions };\n  }\n\n  const failedConditions: RuleCondition[] = [];\n\n  for (const condition of rule.conditions) {\n    if (!evaluateCondition(condition, context)) {\n      failedConditions.push(condition);\n    }\n  }\n\n  return {\n    matched: failedConditions.length === 0,\n    failedConditions,\n  };\n}\n\n/**\n * Evaluate all rules and return the first matching rule (by priority)\n */\nexport function evaluateRules(\n  rules: ApprovalRule[],\n  context: RuleEvaluationContext\n): RuleEvaluationResult {\n  // Sort rules by priority (lower number = higher priority)\n  const sortedRules = [...rules].sort((a, b) => a.priority - b.priority);\n\n  const evaluations: RuleEvaluationResult[\"evaluations\"] = [];\n  let matchedRule: ApprovalRule | undefined;\n\n  for (const rule of sortedRules) {\n    const { matched, failedConditions } = evaluateRule(rule, context);\n\n    evaluations.push({\n      rule,\n      matched,\n      failedConditions,\n    });\n\n    if (matched && !matchedRule) {\n      matchedRule = rule;\n      // Continue evaluating remaining rules for completeness\n    }\n  }\n\n  const result: RuleEvaluationResult = {\n    matched: matchedRule !== undefined,\n    evaluations,\n  };\n\n  if (matchedRule) {\n    result.matchedRule = matchedRule;\n    result.action = matchedRule.action;\n  }\n\n  return result;\n}\n\n/**\n * Get required approvers based on rule evaluation result\n */\nexport function getRequiredApprovers(result: RuleEvaluationResult): string[] {\n  if (!result.matched || !result.action) {\n    return [];\n  }\n\n  switch (result.action.type) {\n    case \"require_approval\":\n    case \"require_multi_approval\":\n      return result.action.approverIds ?? [];\n\n    case \"escalate\":\n      return result.action.escalateTo ? [result.action.escalateTo] : [];\n\n    default:\n      return [];\n  }\n}\n\n/**\n * Check if approval is required based on rules\n */\nexport function requiresApproval(result: RuleEvaluationResult): boolean {\n  if (!result.matched || !result.action) {\n    // Default: require approval if no rule matches\n    return true;\n  }\n\n  return (\n    result.action.type === \"require_approval\" ||\n    result.action.type === \"require_multi_approval\" ||\n    result.action.type === \"escalate\"\n  );\n}\n\n/**\n * Check if auto-approval is allowed based on rules\n */\nexport function canAutoApprove(result: RuleEvaluationResult): boolean {\n  return result.matched && result.action?.type === \"auto_approve\";\n}\n\n/**\n * Check if request should be rejected based on rules\n */\nexport function shouldReject(result: RuleEvaluationResult): boolean {\n  return result.matched && result.action?.type === \"reject\";\n}\n\n/**\n * Create a simple amount-based approval rule\n */\nexport function createAmountRule(\n  id: string,\n  name: string,\n  threshold: number,\n  action: RuleAction,\n  priority: number = 100\n): ApprovalRule {\n  return {\n    id,\n    name,\n    conditions: [\n      {\n        type: \"amount_greater_than\",\n        value: threshold,\n      },\n    ],\n    action,\n    priority,\n    isActive: true,\n  };\n}\n\n/**\n * Create a role-based approval rule\n */\nexport function createRoleRule(\n  id: string,\n  name: string,\n  roles: string[],\n  action: RuleAction,\n  priority: number = 100\n): ApprovalRule {\n  return {\n    id,\n    name,\n    conditions: [\n      {\n        type: \"user_role_in\",\n        value: roles,\n      },\n    ],\n    action,\n    priority,\n    isActive: true,\n  };\n}\n\n/**\n * Create a department-based approval rule\n */\nexport function createDepartmentRule(\n  id: string,\n  name: string,\n  departments: string[],\n  action: RuleAction,\n  priority: number = 100\n): ApprovalRule {\n  return {\n    id,\n    name,\n    conditions: [\n      {\n        type: \"department_in\",\n        value: departments,\n      },\n    ],\n    action,\n    priority,\n    isActive: true,\n  };\n}\n\n/**\n * Default approval rules for B2B\n */\nexport const DEFAULT_APPROVAL_RULES: ApprovalRule[] = [\n  {\n    id: \"auto-approve-small\",\n    name: \"Auto-approve small orders\",\n    description: \"Automatically approve orders under 500\",\n    conditions: [{ type: \"amount_less_than\", value: 500 }],\n    action: { type: \"auto_approve\" },\n    priority: 10,\n    isActive: true,\n  },\n  {\n    id: \"manager-approval-medium\",\n    name: \"Manager approval for medium orders\",\n    description: \"Require manager approval for orders 500-5000\",\n    conditions: [{ type: \"amount_between\", value: 500, valueTo: 5000 }],\n    action: {\n      type: \"require_approval\",\n      approverIds: [], // To be filled with manager IDs\n    },\n    priority: 20,\n    isActive: true,\n  },\n  {\n    id: \"executive-approval-large\",\n    name: \"Executive approval for large orders\",\n    description: \"Require executive approval for orders over 5000\",\n    conditions: [{ type: \"amount_greater_than\", value: 5000 }],\n    action: {\n      type: \"require_multi_approval\",\n      approverIds: [], // To be filled with executive IDs\n      requiredApprovals: 2,\n    },\n    priority: 30,\n    isActive: true,\n  },\n];\n","/**\n * Spending Calculator Utilities\n *\n * Functions for calculating spending limits, usage, and projections.\n */\n\n/**\n * Spending period type\n */\nexport type SpendingPeriodType =\n  | \"daily\"\n  | \"weekly\"\n  | \"monthly\"\n  | \"quarterly\"\n  | \"yearly\";\n\n/**\n * Spending record\n */\nexport interface SpendingRecord {\n  amount: number;\n  date: Date;\n  category?: string;\n  reference?: string;\n}\n\n/**\n * Spending limit configuration\n */\nexport interface SpendingLimitConfig {\n  maxAmount: number;\n  period: SpendingPeriodType;\n  softLimitPercentage?: number; // e.g., 75 for 75%\n  hardLimitPercentage?: number; // e.g., 100 for 100%\n  rollover?: boolean; // Whether unused amount rolls over\n  rolloverPercentage?: number; // Max percentage to roll over\n}\n\n/**\n * Spending calculation result\n */\nexport interface SpendingCalculation {\n  /** Total spent in current period */\n  totalSpent: number;\n  /** Remaining amount */\n  remaining: number;\n  /** Usage percentage */\n  percentage: number;\n  /** Whether soft limit is exceeded */\n  softLimitExceeded: boolean;\n  /** Whether hard limit is exceeded */\n  hardLimitExceeded: boolean;\n  /** Period start date */\n  periodStart: Date;\n  /** Period end date */\n  periodEnd: Date;\n  /** Days remaining in period */\n  daysRemaining: number;\n  /** Average daily spending */\n  averageDaily: number;\n  /** Projected end-of-period spending */\n  projected: number;\n  /** Whether on track to stay under limit */\n  onTrack: boolean;\n  /** Recommended daily budget to stay under limit */\n  recommendedDaily: number;\n}\n\n/**\n * Get period start and end dates\n */\nexport function getPeriodDates(\n  period: SpendingPeriodType,\n  referenceDate: Date = new Date()\n): { start: Date; end: Date } {\n  const date = new Date(referenceDate);\n\n  switch (period) {\n    case \"daily\": {\n      const start = new Date(date);\n      start.setHours(0, 0, 0, 0);\n      const end = new Date(start);\n      end.setDate(end.getDate() + 1);\n      end.setMilliseconds(-1);\n      return { start, end };\n    }\n\n    case \"weekly\": {\n      const start = new Date(date);\n      const day = start.getDay();\n      const diff = start.getDate() - day + (day === 0 ? -6 : 1); // Monday\n      start.setDate(diff);\n      start.setHours(0, 0, 0, 0);\n      const end = new Date(start);\n      end.setDate(end.getDate() + 7);\n      end.setMilliseconds(-1);\n      return { start, end };\n    }\n\n    case \"monthly\": {\n      const start = new Date(date.getFullYear(), date.getMonth(), 1);\n      const end = new Date(date.getFullYear(), date.getMonth() + 1, 0, 23, 59, 59, 999);\n      return { start, end };\n    }\n\n    case \"quarterly\": {\n      const quarter = Math.floor(date.getMonth() / 3);\n      const start = new Date(date.getFullYear(), quarter * 3, 1);\n      const end = new Date(date.getFullYear(), quarter * 3 + 3, 0, 23, 59, 59, 999);\n      return { start, end };\n    }\n\n    case \"yearly\": {\n      const start = new Date(date.getFullYear(), 0, 1);\n      const end = new Date(date.getFullYear(), 11, 31, 23, 59, 59, 999);\n      return { start, end };\n    }\n\n    default:\n      throw new Error(`Unknown period type: ${period}`);\n  }\n}\n\n/**\n * Calculate days between two dates\n */\nexport function daysBetween(start: Date, end: Date): number {\n  const msPerDay = 24 * 60 * 60 * 1000;\n  return Math.ceil((end.getTime() - start.getTime()) / msPerDay);\n}\n\n/**\n * Filter spending records by date range\n */\nexport function filterByPeriod(\n  records: SpendingRecord[],\n  start: Date,\n  end: Date\n): SpendingRecord[] {\n  return records.filter(\n    (record) => record.date >= start && record.date <= end\n  );\n}\n\n/**\n * Calculate total spending from records\n */\nexport function calculateTotal(records: SpendingRecord[]): number {\n  return records.reduce((sum, record) => sum + record.amount, 0);\n}\n\n/**\n * Calculate spending by category\n */\nexport function calculateByCategory(\n  records: SpendingRecord[]\n): Record<string, number> {\n  const byCategory: Record<string, number> = {};\n\n  for (const record of records) {\n    const category = record.category ?? \"uncategorized\";\n    byCategory[category] = (byCategory[category] ?? 0) + record.amount;\n  }\n\n  return byCategory;\n}\n\n/**\n * Calculate spending by day\n */\nexport function calculateByDay(\n  records: SpendingRecord[]\n): Record<string, number> {\n  const byDay: Record<string, number> = {};\n\n  for (const record of records) {\n    const isoString = record.date.toISOString();\n    const day = isoString.split(\"T\")[0] ?? isoString.substring(0, 10);\n    byDay[day] = (byDay[day] ?? 0) + record.amount;\n  }\n\n  return byDay;\n}\n\n/**\n * Calculate complete spending metrics\n */\nexport function calculateSpending(\n  records: SpendingRecord[],\n  config: SpendingLimitConfig,\n  referenceDate: Date = new Date()\n): SpendingCalculation {\n  const { start: periodStart, end: periodEnd } = getPeriodDates(\n    config.period,\n    referenceDate\n  );\n\n  // Filter records for current period\n  const periodRecords = filterByPeriod(records, periodStart, periodEnd);\n  const totalSpent = calculateTotal(periodRecords);\n\n  // Calculate remaining\n  const remaining = Math.max(0, config.maxAmount - totalSpent);\n\n  // Calculate percentage\n  const percentage =\n    config.maxAmount > 0 ? (totalSpent / config.maxAmount) * 100 : 0;\n\n  // Check limits\n  const softLimitPercentage = config.softLimitPercentage ?? 75;\n  const hardLimitPercentage = config.hardLimitPercentage ?? 100;\n  const softLimitExceeded = percentage >= softLimitPercentage;\n  const hardLimitExceeded = percentage >= hardLimitPercentage;\n\n  // Calculate days\n  const now = new Date(referenceDate);\n  const daysInPeriod = daysBetween(periodStart, periodEnd);\n  const daysElapsed = Math.max(1, daysBetween(periodStart, now));\n  const daysRemaining = Math.max(0, daysBetween(now, periodEnd));\n\n  // Calculate averages and projections\n  const averageDaily = totalSpent / daysElapsed;\n  const projected = averageDaily * daysInPeriod;\n  const onTrack = projected <= config.maxAmount;\n\n  // Calculate recommended daily budget\n  const recommendedDaily =\n    daysRemaining > 0 ? remaining / daysRemaining : 0;\n\n  return {\n    totalSpent,\n    remaining,\n    percentage,\n    softLimitExceeded,\n    hardLimitExceeded,\n    periodStart,\n    periodEnd,\n    daysRemaining,\n    averageDaily,\n    projected,\n    onTrack,\n    recommendedDaily,\n  };\n}\n\n/**\n * Calculate rollover amount from previous period\n */\nexport function calculateRollover(\n  previousPeriodSpent: number,\n  config: SpendingLimitConfig\n): number {\n  if (!config.rollover) return 0;\n\n  const unused = Math.max(0, config.maxAmount - previousPeriodSpent);\n  const rolloverPercentage = config.rolloverPercentage ?? 100;\n\n  return unused * (rolloverPercentage / 100);\n}\n\n/**\n * Calculate effective limit including rollover\n */\nexport function calculateEffectiveLimit(\n  config: SpendingLimitConfig,\n  rolloverAmount: number = 0\n): number {\n  return config.maxAmount + rolloverAmount;\n}\n\n/**\n * Check if a purchase can be made within limit\n */\nexport function canMakePurchase(\n  purchaseAmount: number,\n  currentSpent: number,\n  limit: number,\n  allowExceed: boolean = false\n): { allowed: boolean; reason?: string } {\n  if (allowExceed) {\n    return { allowed: true };\n  }\n\n  const newTotal = currentSpent + purchaseAmount;\n\n  if (newTotal > limit) {\n    return {\n      allowed: false,\n      reason: `Purchase would exceed spending limit. Current: ${currentSpent}, Purchase: ${purchaseAmount}, Limit: ${limit}`,\n    };\n  }\n\n  return { allowed: true };\n}\n\n/**\n * Calculate spending trend\n */\nexport function calculateTrend(\n  currentPeriodSpent: number,\n  previousPeriodSpent: number\n): { direction: \"up\" | \"down\" | \"stable\"; percentage: number } {\n  if (previousPeriodSpent === 0) {\n    return {\n      direction: currentPeriodSpent > 0 ? \"up\" : \"stable\",\n      percentage: currentPeriodSpent > 0 ? 100 : 0,\n    };\n  }\n\n  const change =\n    ((currentPeriodSpent - previousPeriodSpent) / previousPeriodSpent) * 100;\n\n  let direction: \"up\" | \"down\" | \"stable\";\n  if (Math.abs(change) < 1) {\n    direction = \"stable\";\n  } else if (change > 0) {\n    direction = \"up\";\n  } else {\n    direction = \"down\";\n  }\n\n  return {\n    direction,\n    percentage: Math.abs(change),\n  };\n}\n\n/**\n * Generate spending forecast\n */\nexport function generateForecast(\n  records: SpendingRecord[],\n  config: SpendingLimitConfig,\n  forecastDays: number = 30\n): Array<{ date: Date; projected: number; limit: number }> {\n  const { start: periodStart } = getPeriodDates(config.period);\n  const periodRecords = filterByPeriod(\n    records,\n    periodStart,\n    new Date()\n  );\n\n  const byDay = calculateByDay(periodRecords);\n  const days = Object.keys(byDay);\n\n  // Calculate average daily spending\n  const total = calculateTotal(periodRecords);\n  const avgDaily = days.length > 0 ? total / days.length : 0;\n\n  // Generate forecast\n  const forecast: Array<{ date: Date; projected: number; limit: number }> = [];\n  let cumulative = total;\n\n  for (let i = 1; i <= forecastDays; i++) {\n    const date = new Date();\n    date.setDate(date.getDate() + i);\n    cumulative += avgDaily;\n\n    forecast.push({\n      date,\n      projected: cumulative,\n      limit: config.maxAmount,\n    });\n  }\n\n  return forecast;\n}\n\n/**\n * Calculate savings opportunity\n */\nexport function calculateSavingsOpportunity(\n  records: SpendingRecord[],\n  targetPercentage: number = 10\n): { potentialSavings: number; suggestions: string[] } {\n  const byCategory = calculateByCategory(records);\n  const total = calculateTotal(records);\n  const targetSavings = total * (targetPercentage / 100);\n\n  const suggestions: string[] = [];\n  let potentialSavings = 0;\n\n  // Sort categories by spending (highest first)\n  const sortedCategories = Object.entries(byCategory).sort(\n    ([, a], [, b]) => b - a\n  );\n\n  for (const [category, amount] of sortedCategories) {\n    const categoryPercentage = (amount / total) * 100;\n    if (categoryPercentage > 20) {\n      const savingAmount = amount * 0.1; // 10% reduction suggestion\n      potentialSavings += savingAmount;\n      suggestions.push(\n        `Reduce \"${category}\" spending by 10% to save ${savingAmount.toFixed(2)}`\n      );\n    }\n\n    if (potentialSavings >= targetSavings) break;\n  }\n\n  return {\n    potentialSavings,\n    suggestions,\n  };\n}\n","/**\n * CSV Parser Utilities\n *\n * Functions for parsing and validating CSV data for bulk imports.\n */\n\n/**\n * CSV parsing options\n */\nexport interface CsvParseOptions {\n  /** Field delimiter (default: ',') */\n  delimiter?: string;\n  /** Whether first row is header (default: true) */\n  hasHeader?: boolean;\n  /** Quote character (default: '\"') */\n  quote?: string;\n  /** Whether to trim whitespace from values (default: true) */\n  trim?: boolean;\n  /** Whether to skip empty lines (default: true) */\n  skipEmptyLines?: boolean;\n  /** Maximum number of rows to parse (0 = unlimited) */\n  maxRows?: number;\n  /** Expected column names (for validation) */\n  expectedColumns?: string[];\n  /** Required column names (must be present) */\n  requiredColumns?: string[];\n}\n\n/**\n * CSV parse result\n */\nexport interface CsvParseResult<T = Record<string, string>> {\n  /** Parsed data rows */\n  data: T[];\n  /** Column headers */\n  headers: string[];\n  /** Total rows parsed (including header) */\n  totalRows: number;\n  /** Errors encountered during parsing */\n  errors: CsvParseError[];\n  /** Whether parsing was successful */\n  success: boolean;\n  /** Raw parsed rows (before type conversion) */\n  rawRows: string[][];\n}\n\n/**\n * CSV parse error\n */\nexport interface CsvParseError {\n  /** Row number (1-indexed) */\n  row: number;\n  /** Column number (1-indexed) */\n  column?: number;\n  /** Column name */\n  columnName?: string;\n  /** Error message */\n  message: string;\n  /** Error type */\n  type: \"parse\" | \"validation\" | \"missing_required\" | \"invalid_value\";\n  /** Raw value that caused the error */\n  value?: string;\n}\n\n/**\n * Column mapping configuration\n */\nexport interface ColumnMapping {\n  /** Source column name (from CSV) */\n  source: string;\n  /** Target field name */\n  target: string;\n  /** Whether column is required */\n  required?: boolean;\n  /** Default value if empty */\n  defaultValue?: unknown;\n  /** Transform function */\n  transform?: (value: string) => unknown;\n  /** Validation function */\n  validate?: (value: string) => boolean | string;\n}\n\n/**\n * Parse a CSV line respecting quotes\n */\nfunction parseLine(\n  line: string,\n  delimiter: string,\n  quote: string\n): string[] {\n  const result: string[] = [];\n  let current = \"\";\n  let inQuotes = false;\n  let i = 0;\n\n  while (i < line.length) {\n    const char = line[i];\n\n    if (char === quote) {\n      if (inQuotes && line[i + 1] === quote) {\n        // Escaped quote\n        current += quote;\n        i += 2;\n        continue;\n      }\n      inQuotes = !inQuotes;\n      i++;\n      continue;\n    }\n\n    if (char === delimiter && !inQuotes) {\n      result.push(current);\n      current = \"\";\n      i++;\n      continue;\n    }\n\n    current += char;\n    i++;\n  }\n\n  result.push(current);\n  return result;\n}\n\n/**\n * Parse CSV string into rows and columns\n */\nexport function parseCsv<T = Record<string, string>>(\n  csvString: string,\n  options: CsvParseOptions = {}\n): CsvParseResult<T> {\n  const {\n    delimiter = \",\",\n    hasHeader = true,\n    quote = '\"',\n    trim = true,\n    skipEmptyLines = true,\n    maxRows = 0,\n    expectedColumns,\n    requiredColumns,\n  } = options;\n\n  const errors: CsvParseError[] = [];\n  const rawRows: string[][] = [];\n\n  // Split into lines\n  const lines = csvString.split(/\\r?\\n/);\n\n  // Parse each line\n  let rowIndex = 0;\n  for (const line of lines) {\n    // Skip empty lines\n    if (skipEmptyLines && line.trim() === \"\") {\n      continue;\n    }\n\n    // Check max rows\n    if (maxRows > 0 && rowIndex >= maxRows) {\n      break;\n    }\n\n    try {\n      let values = parseLine(line, delimiter, quote);\n\n      if (trim) {\n        values = values.map((v) => v.trim());\n      }\n\n      rawRows.push(values);\n      rowIndex++;\n    } catch {\n      errors.push({\n        row: rowIndex + 1,\n        message: `Failed to parse line: ${line.substring(0, 50)}...`,\n        type: \"parse\",\n      });\n      rowIndex++;\n    }\n  }\n\n  if (rawRows.length === 0) {\n    return {\n      data: [],\n      headers: [],\n      totalRows: 0,\n      errors: [{ row: 0, message: \"Empty CSV file\", type: \"parse\" }],\n      success: false,\n      rawRows: [],\n    };\n  }\n\n  // Extract headers\n  const firstRow = rawRows[0];\n  if (!firstRow) {\n    return {\n      data: [],\n      headers: [],\n      totalRows: 0,\n      errors: [{ row: 0, message: \"No data rows found\", type: \"parse\" }],\n      success: false,\n      rawRows: [],\n    };\n  }\n  const headers: string[] = hasHeader ? firstRow : firstRow.map((_, i) => `column_${i + 1}`);\n  const dataRows = hasHeader ? rawRows.slice(1) : rawRows;\n\n  // Validate expected columns\n  if (expectedColumns) {\n    const missingColumns = expectedColumns.filter(\n      (col) => !headers.includes(col)\n    );\n    if (missingColumns.length > 0) {\n      errors.push({\n        row: 1,\n        message: `Missing expected columns: ${missingColumns.join(\", \")}`,\n        type: \"validation\",\n      });\n    }\n  }\n\n  // Validate required columns\n  if (requiredColumns) {\n    const missingRequired = requiredColumns.filter(\n      (col) => !headers.includes(col)\n    );\n    if (missingRequired.length > 0) {\n      errors.push({\n        row: 1,\n        message: `Missing required columns: ${missingRequired.join(\", \")}`,\n        type: \"missing_required\",\n      });\n    }\n  }\n\n  // Convert to objects\n  const data: T[] = dataRows.map((row, index) => {\n    const obj: Record<string, string> = {};\n    headers.forEach((header, colIndex) => {\n      obj[header] = row[colIndex] ?? \"\";\n    });\n    return obj as T;\n  });\n\n  return {\n    data,\n    headers,\n    totalRows: rawRows.length,\n    errors,\n    success: errors.filter((e) => e.type !== \"validation\").length === 0,\n    rawRows,\n  };\n}\n\n/**\n * Map CSV columns to target fields\n */\nexport function mapColumns<T>(\n  data: Record<string, string>[],\n  mappings: ColumnMapping[]\n): { data: T[]; errors: CsvParseError[] } {\n  const errors: CsvParseError[] = [];\n  const result: T[] = [];\n\n  data.forEach((row, rowIndex) => {\n    const mapped: Record<string, unknown> = {};\n\n    for (const mapping of mappings) {\n      const rawValue = row[mapping.source];\n\n      // Check required\n      if (mapping.required && (rawValue === undefined || rawValue === \"\")) {\n        const error: CsvParseError = {\n          row: rowIndex + 2, // +2 for header and 0-indexing\n          columnName: mapping.source,\n          message: `Required field \"${mapping.source}\" is empty`,\n          type: \"missing_required\",\n        };\n        if (rawValue !== undefined) {\n          error.value = rawValue;\n        }\n        errors.push(error);\n        continue;\n      }\n\n      // Use default value if empty\n      if ((rawValue === undefined || rawValue === \"\") && mapping.defaultValue !== undefined) {\n        mapped[mapping.target] = mapping.defaultValue;\n        continue;\n      }\n\n      // Validate\n      if (mapping.validate && rawValue !== undefined && rawValue !== \"\") {\n        const validationResult = mapping.validate(rawValue);\n        if (validationResult !== true) {\n          errors.push({\n            row: rowIndex + 2,\n            columnName: mapping.source,\n            message:\n              typeof validationResult === \"string\"\n                ? validationResult\n                : `Invalid value for \"${mapping.source}\"`,\n            type: \"invalid_value\",\n            value: rawValue,\n          });\n          continue;\n        }\n      }\n\n      // Transform\n      if (mapping.transform && rawValue !== undefined) {\n        try {\n          mapped[mapping.target] = mapping.transform(rawValue);\n        } catch {\n          errors.push({\n            row: rowIndex + 2,\n            columnName: mapping.source,\n            message: `Failed to transform value for \"${mapping.source}\"`,\n            type: \"invalid_value\",\n            value: rawValue,\n          });\n        }\n      } else {\n        mapped[mapping.target] = rawValue;\n      }\n    }\n\n    result.push(mapped as T);\n  });\n\n  return { data: result, errors };\n}\n\n/**\n * Generate CSV string from data\n */\nexport function generateCsv<T extends Record<string, unknown>>(\n  data: T[],\n  options: {\n    columns?: string[];\n    delimiter?: string;\n    includeHeader?: boolean;\n    quote?: string;\n  } = {}\n): string {\n  const {\n    columns,\n    delimiter = \",\",\n    includeHeader = true,\n    quote = '\"',\n  } = options;\n\n  if (data.length === 0) {\n    return columns && includeHeader ? columns.join(delimiter) : \"\";\n  }\n\n  const firstDataRow = data[0];\n  const headers: string[] = columns ?? (firstDataRow ? Object.keys(firstDataRow) : []);\n\n  const escapeValue = (value: unknown): string => {\n    const str = String(value ?? \"\");\n    if (\n      str.includes(delimiter) ||\n      str.includes(quote) ||\n      str.includes(\"\\n\") ||\n      str.includes(\"\\r\")\n    ) {\n      return `${quote}${str.replace(new RegExp(quote, \"g\"), quote + quote)}${quote}`;\n    }\n    return str;\n  };\n\n  const lines: string[] = [];\n\n  if (includeHeader) {\n    lines.push(headers.map(escapeValue).join(delimiter));\n  }\n\n  for (const row of data) {\n    const values = headers.map((header) => escapeValue(row[header]));\n    lines.push(values.join(delimiter));\n  }\n\n  return lines.join(\"\\n\");\n}\n\n/**\n * Common column mappings for employee import\n */\nexport const EMPLOYEE_COLUMN_MAPPINGS: ColumnMapping[] = [\n  {\n    source: \"first_name\",\n    target: \"firstName\",\n    required: true,\n    validate: (v) => v.length > 0 || \"First name is required\",\n  },\n  {\n    source: \"last_name\",\n    target: \"lastName\",\n    required: true,\n    validate: (v) => v.length > 0 || \"Last name is required\",\n  },\n  {\n    source: \"email\",\n    target: \"email\",\n    required: true,\n    validate: (v) =>\n      /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(v) || \"Invalid email format\",\n  },\n  {\n    source: \"phone\",\n    target: \"phone\",\n    required: false,\n  },\n  {\n    source: \"role\",\n    target: \"role\",\n    required: false,\n    defaultValue: \"viewer\",\n    validate: (v) =>\n      [\"admin\", \"manager\", \"purchaser\", \"viewer\", \"approver\"].includes(v) ||\n      \"Invalid role\",\n  },\n  {\n    source: \"department\",\n    target: \"department\",\n    required: false,\n  },\n  {\n    source: \"job_title\",\n    target: \"jobTitle\",\n    required: false,\n  },\n  {\n    source: \"employee_number\",\n    target: \"employeeNumber\",\n    required: false,\n  },\n  {\n    source: \"monthly_limit\",\n    target: \"monthlyLimit\",\n    required: false,\n    transform: (v) => (v ? parseFloat(v) : undefined),\n    validate: (v) => !v || !isNaN(parseFloat(v)) || \"Invalid number\",\n  },\n  {\n    source: \"order_limit\",\n    target: \"orderLimit\",\n    required: false,\n    transform: (v) => (v ? parseFloat(v) : undefined),\n    validate: (v) => !v || !isNaN(parseFloat(v)) || \"Invalid number\",\n  },\n  {\n    source: \"manager_id\",\n    target: \"managerId\",\n    required: false,\n  },\n];\n\n/**\n * Generate a sample CSV template\n */\nexport function generateTemplate(\n  mappings: ColumnMapping[],\n  sampleData?: Record<string, string>[]\n): string {\n  const headers = mappings.map((m) => m.source);\n\n  if (!sampleData || sampleData.length === 0) {\n    return headers.join(\",\");\n  }\n\n  return generateCsv(sampleData, { columns: headers });\n}\n\n/**\n * Validate CSV file size\n */\nexport function validateFileSize(\n  file: File | Blob,\n  maxSizeBytes: number = 10 * 1024 * 1024 // 10MB default\n): { valid: boolean; error?: string } {\n  if (file.size > maxSizeBytes) {\n    const maxSizeMB = (maxSizeBytes / (1024 * 1024)).toFixed(1);\n    const fileSizeMB = (file.size / (1024 * 1024)).toFixed(1);\n    return {\n      valid: false,\n      error: `File size (${fileSizeMB}MB) exceeds maximum allowed size (${maxSizeMB}MB)`,\n    };\n  }\n  return { valid: true };\n}\n\n/**\n * Read CSV file content as string (browser-compatible)\n *\n * Note: This function requires browser environment with FileReader API.\n * For Node.js, use fs.readFileSync and then parseCsv.\n *\n * @example\n * ```tsx\n * // Browser usage\n * const handleFileUpload = async (file: File) => {\n *   const text = await readFileAsText(file);\n *   const result = parseCsv(text, { requiredColumns: ['email', 'name'] });\n *   return result;\n * };\n * ```\n */\nexport function readFileAsText(file: Blob): Promise<string> {\n  return new Promise((resolve, reject) => {\n    if (typeof FileReader === \"undefined\") {\n      reject(new Error(\"FileReader is not available in this environment\"));\n      return;\n    }\n\n    const reader = new FileReader();\n\n    reader.onload = (event: ProgressEvent<FileReader>) => {\n      const result = event.target?.result;\n      if (typeof result === \"string\") {\n        resolve(result);\n      } else {\n        reject(new Error(\"Failed to read file as text\"));\n      }\n    };\n\n    reader.onerror = () => {\n      reject(new Error(\"Failed to read file\"));\n    };\n\n    reader.readAsText(file);\n  });\n}\n\n/**\n * Read and parse CSV file (browser-compatible)\n *\n * Combines file reading and parsing in one operation.\n *\n * @example\n * ```tsx\n * const handleFileUpload = async (file: File) => {\n *   const result = await readAndParseCsv(file, {\n *     requiredColumns: ['email', 'name'],\n *   });\n *   if (result.success) {\n *     console.log('Parsed rows:', result.data);\n *   }\n * };\n * ```\n */\nexport async function readAndParseCsv<T = Record<string, string>>(\n  file: Blob,\n  options: CsvParseOptions = {}\n): Promise<CsvParseResult<T>> {\n  const text = await readFileAsText(file);\n  return parseCsv<T>(text, options);\n}\n","/**\n * B2B-specific Formatting Utilities\n *\n * Functions for formatting currencies, dates, numbers,\n * and other B2B-specific data.\n */\n\n/**\n * Currency configuration\n */\nexport interface CurrencyFormatOptions {\n  /** Currency code (e.g., 'EUR', 'USD') */\n  code?: string;\n  /** Locale for formatting */\n  locale?: string;\n  /** Minimum fraction digits */\n  minimumFractionDigits?: number;\n  /** Maximum fraction digits */\n  maximumFractionDigits?: number;\n  /** Whether to show currency symbol */\n  showSymbol?: boolean;\n  /** Whether to show currency code */\n  showCode?: boolean;\n}\n\n/**\n * Date format options\n */\nexport interface DateFormatOptions {\n  /** Date format style */\n  style?: \"short\" | \"medium\" | \"long\" | \"full\";\n  /** Include time */\n  includeTime?: boolean;\n  /** Time style */\n  timeStyle?: \"short\" | \"medium\" | \"long\";\n  /** Locale for formatting */\n  locale?: string;\n  /** Custom format pattern */\n  pattern?: string;\n}\n\n/**\n * Number format options\n */\nexport interface NumberFormatOptions {\n  /** Locale for formatting */\n  locale?: string;\n  /** Minimum fraction digits */\n  minimumFractionDigits?: number;\n  /** Maximum fraction digits */\n  maximumFractionDigits?: number;\n  /** Use grouping separators */\n  useGrouping?: boolean;\n  /** Notation style */\n  notation?: \"standard\" | \"scientific\" | \"engineering\" | \"compact\";\n  /** Compact display */\n  compactDisplay?: \"short\" | \"long\";\n}\n\n// Default locale\nconst DEFAULT_LOCALE = \"fr-FR\";\n\n/**\n * Format currency amount\n */\nexport function formatCurrency(\n  amount: number,\n  options: CurrencyFormatOptions = {}\n): string {\n  const {\n    code = \"EUR\",\n    locale = DEFAULT_LOCALE,\n    minimumFractionDigits = 2,\n    maximumFractionDigits = 2,\n    showSymbol = true,\n    showCode = false,\n  } = options;\n\n  if (showSymbol) {\n    const formatter = new Intl.NumberFormat(locale, {\n      style: \"currency\",\n      currency: code,\n      minimumFractionDigits,\n      maximumFractionDigits,\n    });\n    return formatter.format(amount);\n  }\n\n  const formatter = new Intl.NumberFormat(locale, {\n    minimumFractionDigits,\n    maximumFractionDigits,\n  });\n\n  const formatted = formatter.format(amount);\n  return showCode ? `${formatted} ${code}` : formatted;\n}\n\n/**\n * Format currency with abbreviated large numbers\n */\nexport function formatCurrencyCompact(\n  amount: number,\n  options: CurrencyFormatOptions = {}\n): string {\n  const { code = \"EUR\", locale = DEFAULT_LOCALE } = options;\n\n  const formatter = new Intl.NumberFormat(locale, {\n    style: \"currency\",\n    currency: code,\n    notation: \"compact\",\n    compactDisplay: \"short\",\n    maximumFractionDigits: 1,\n  });\n\n  return formatter.format(amount);\n}\n\n/**\n * Format date\n */\nexport function formatDate(\n  date: Date | string | number,\n  options: DateFormatOptions = {}\n): string {\n  const {\n    style = \"medium\",\n    includeTime = false,\n    timeStyle = \"short\",\n    locale = DEFAULT_LOCALE,\n  } = options;\n\n  const dateObj = date instanceof Date ? date : new Date(date);\n\n  if (isNaN(dateObj.getTime())) {\n    return \"Invalid date\";\n  }\n\n  const dateStyleMap: Record<string, Intl.DateTimeFormatOptions[\"dateStyle\"]> = {\n    short: \"short\",\n    medium: \"medium\",\n    long: \"long\",\n    full: \"full\",\n  };\n\n  const timeStyleMap: Record<string, Intl.DateTimeFormatOptions[\"timeStyle\"]> = {\n    short: \"short\",\n    medium: \"medium\",\n    long: \"long\",\n  };\n\n  const formatOptions: Intl.DateTimeFormatOptions = {\n    dateStyle: dateStyleMap[style],\n  };\n\n  if (includeTime) {\n    formatOptions.timeStyle = timeStyleMap[timeStyle];\n  }\n\n  return new Intl.DateTimeFormat(locale, formatOptions).format(dateObj);\n}\n\n/**\n * Format relative date (e.g., \"2 days ago\", \"in 3 hours\")\n */\nexport function formatRelativeDate(\n  date: Date | string | number,\n  locale: string = DEFAULT_LOCALE\n): string {\n  const dateObj = date instanceof Date ? date : new Date(date);\n  const now = new Date();\n  const diffMs = dateObj.getTime() - now.getTime();\n  const diffSeconds = Math.round(diffMs / 1000);\n  const diffMinutes = Math.round(diffSeconds / 60);\n  const diffHours = Math.round(diffMinutes / 60);\n  const diffDays = Math.round(diffHours / 24);\n  const diffWeeks = Math.round(diffDays / 7);\n  const diffMonths = Math.round(diffDays / 30);\n  const diffYears = Math.round(diffDays / 365);\n\n  const rtf = new Intl.RelativeTimeFormat(locale, { numeric: \"auto\" });\n\n  if (Math.abs(diffSeconds) < 60) {\n    return rtf.format(diffSeconds, \"second\");\n  }\n  if (Math.abs(diffMinutes) < 60) {\n    return rtf.format(diffMinutes, \"minute\");\n  }\n  if (Math.abs(diffHours) < 24) {\n    return rtf.format(diffHours, \"hour\");\n  }\n  if (Math.abs(diffDays) < 7) {\n    return rtf.format(diffDays, \"day\");\n  }\n  if (Math.abs(diffWeeks) < 4) {\n    return rtf.format(diffWeeks, \"week\");\n  }\n  if (Math.abs(diffMonths) < 12) {\n    return rtf.format(diffMonths, \"month\");\n  }\n  return rtf.format(diffYears, \"year\");\n}\n\n/**\n * Format number\n */\nexport function formatNumber(\n  value: number,\n  options: NumberFormatOptions = {}\n): string {\n  const {\n    locale = DEFAULT_LOCALE,\n    minimumFractionDigits,\n    maximumFractionDigits,\n    useGrouping = true,\n    notation = \"standard\",\n    compactDisplay = \"short\",\n  } = options;\n\n  const formatter = new Intl.NumberFormat(locale, {\n    minimumFractionDigits,\n    maximumFractionDigits,\n    useGrouping,\n    notation,\n    compactDisplay: notation === \"compact\" ? compactDisplay : undefined,\n  });\n\n  return formatter.format(value);\n}\n\n/**\n * Format percentage\n */\nexport function formatPercentage(\n  value: number,\n  options: {\n    locale?: string;\n    minimumFractionDigits?: number;\n    maximumFractionDigits?: number;\n    showSign?: boolean;\n  } = {}\n): string {\n  const {\n    locale = DEFAULT_LOCALE,\n    minimumFractionDigits = 0,\n    maximumFractionDigits = 1,\n    showSign = false,\n  } = options;\n\n  const formatter = new Intl.NumberFormat(locale, {\n    style: \"percent\",\n    minimumFractionDigits,\n    maximumFractionDigits,\n    signDisplay: showSign ? \"always\" : \"auto\",\n  });\n\n  // Intl.NumberFormat expects 0.5 for 50%, but we often pass 50\n  const normalizedValue = Math.abs(value) > 1 ? value / 100 : value;\n  return formatter.format(normalizedValue);\n}\n\n/**\n * Format order/quote number\n */\nexport function formatOrderNumber(\n  number: string | number,\n  prefix: string = \"ORD\"\n): string {\n  const numStr = String(number).padStart(6, \"0\");\n  return `${prefix}-${numStr}`;\n}\n\n/**\n * Format quote number\n */\nexport function formatQuoteNumber(\n  number: string | number,\n  prefix: string = \"QUO\"\n): string {\n  const numStr = String(number).padStart(6, \"0\");\n  return `${prefix}-${numStr}`;\n}\n\n/**\n * Format invoice number\n */\nexport function formatInvoiceNumber(\n  number: string | number,\n  prefix: string = \"INV\"\n): string {\n  const numStr = String(number).padStart(6, \"0\");\n  return `${prefix}-${numStr}`;\n}\n\n/**\n * Format phone number\n */\nexport function formatPhoneNumber(\n  phone: string,\n  countryCode: string = \"FR\"\n): string {\n  // Remove all non-numeric characters\n  const cleaned = phone.replace(/\\D/g, \"\");\n\n  // Format based on country\n  switch (countryCode) {\n    case \"FR\":\n      // French format: 01 23 45 67 89\n      if (cleaned.length === 10) {\n        return cleaned.replace(/(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})/, \"$1 $2 $3 $4 $5\");\n      }\n      if (cleaned.length === 11 && cleaned.startsWith(\"33\")) {\n        return `+33 ${cleaned.slice(2).replace(/(\\d{1})(\\d{2})(\\d{2})(\\d{2})(\\d{2})/, \"$1 $2 $3 $4 $5\")}`;\n      }\n      break;\n    case \"US\":\n      // US format: (123) 456-7890\n      if (cleaned.length === 10) {\n        return cleaned.replace(/(\\d{3})(\\d{3})(\\d{4})/, \"($1) $2-$3\");\n      }\n      break;\n  }\n\n  return phone; // Return original if no formatting matched\n}\n\n/**\n * Format address for display\n */\nexport function formatAddress(\n  address: {\n    line1?: string;\n    line2?: string;\n    city?: string;\n    state?: string;\n    postalCode?: string;\n    country?: string;\n  },\n  options: { multiline?: boolean; separator?: string } = {}\n): string {\n  const { multiline = false, separator = \", \" } = options;\n\n  const parts: string[] = [];\n\n  if (address.line1) parts.push(address.line1);\n  if (address.line2) parts.push(address.line2);\n\n  const cityParts: string[] = [];\n  if (address.city) cityParts.push(address.city);\n  if (address.state) cityParts.push(address.state);\n  if (address.postalCode) cityParts.push(address.postalCode);\n  if (cityParts.length > 0) parts.push(cityParts.join(\" \"));\n\n  if (address.country) parts.push(address.country);\n\n  return multiline ? parts.join(\"\\n\") : parts.join(separator);\n}\n\n/**\n * Format VAT/Tax ID\n */\nexport function formatVatId(vatId: string, countryCode: string = \"FR\"): string {\n  // Remove all whitespace\n  const cleaned = vatId.replace(/\\s/g, \"\");\n\n  switch (countryCode) {\n    case \"FR\":\n      // French VAT: FR XX XXXXXXXXX\n      if (cleaned.length === 13 && cleaned.startsWith(\"FR\")) {\n        return `FR ${cleaned.slice(2, 4)} ${cleaned.slice(4)}`;\n      }\n      break;\n    case \"DE\":\n      // German VAT: DE XXXXXXXXX\n      if (cleaned.length === 11 && cleaned.startsWith(\"DE\")) {\n        return `DE ${cleaned.slice(2)}`;\n      }\n      break;\n  }\n\n  return vatId;\n}\n\n/**\n * Format file size\n */\nexport function formatFileSize(bytes: number): string {\n  const units = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\"];\n  let unitIndex = 0;\n  let size = bytes;\n\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024;\n    unitIndex++;\n  }\n\n  return `${size.toFixed(unitIndex === 0 ? 0 : 1)} ${units[unitIndex]}`;\n}\n\n/**\n * Format quantity with unit\n */\nexport function formatQuantity(\n  quantity: number,\n  unit?: string,\n  options: NumberFormatOptions = {}\n): string {\n  const formatted = formatNumber(quantity, {\n    ...options,\n    maximumFractionDigits: options.maximumFractionDigits ?? 0,\n  });\n\n  return unit ? `${formatted} ${unit}` : formatted;\n}\n\n/**\n * Format duration (in minutes)\n */\nexport function formatDuration(\n  minutes: number,\n  options: { short?: boolean } = {}\n): string {\n  const { short = false } = options;\n\n  const hours = Math.floor(minutes / 60);\n  const mins = minutes % 60;\n\n  if (short) {\n    if (hours > 0 && mins > 0) {\n      return `${hours}h ${mins}m`;\n    }\n    if (hours > 0) {\n      return `${hours}h`;\n    }\n    return `${mins}m`;\n  }\n\n  const parts: string[] = [];\n  if (hours > 0) {\n    parts.push(`${hours} ${hours === 1 ? \"hour\" : \"hours\"}`);\n  }\n  if (mins > 0 || parts.length === 0) {\n    parts.push(`${mins} ${mins === 1 ? \"minute\" : \"minutes\"}`);\n  }\n\n  return parts.join(\" \");\n}\n\n/**\n * Truncate text with ellipsis\n */\nexport function truncateText(\n  text: string,\n  maxLength: number,\n  options: { ellipsis?: string; wordBoundary?: boolean } = {}\n): string {\n  const { ellipsis = \"...\", wordBoundary = true } = options;\n\n  if (text.length <= maxLength) {\n    return text;\n  }\n\n  let truncated = text.slice(0, maxLength - ellipsis.length);\n\n  if (wordBoundary) {\n    const lastSpace = truncated.lastIndexOf(\" \");\n    if (lastSpace > maxLength * 0.5) {\n      truncated = truncated.slice(0, lastSpace);\n    }\n  }\n\n  return truncated.trim() + ellipsis;\n}\n\n/**\n * Format company name (capitalize appropriately)\n */\nexport function formatCompanyName(name: string): string {\n  // List of words that should remain lowercase\n  const lowercaseWords = new Set([\n    \"and\",\n    \"or\",\n    \"the\",\n    \"a\",\n    \"an\",\n    \"of\",\n    \"in\",\n    \"for\",\n    \"to\",\n    \"et\",\n    \"de\",\n    \"la\",\n    \"le\",\n    \"du\",\n    \"des\",\n  ]);\n\n  // List of words that should remain uppercase\n  const uppercaseWords = new Set([\n    \"sarl\",\n    \"sas\",\n    \"sa\",\n    \"eurl\",\n    \"sci\",\n    \"llc\",\n    \"inc\",\n    \"ltd\",\n    \"plc\",\n    \"gmbh\",\n    \"ag\",\n  ]);\n\n  return name\n    .toLowerCase()\n    .split(/\\s+/)\n    .map((word, index) => {\n      const lowerWord = word.toLowerCase();\n\n      if (uppercaseWords.has(lowerWord)) {\n        return word.toUpperCase();\n      }\n\n      if (index > 0 && lowercaseWords.has(lowerWord)) {\n        return lowerWord;\n      }\n\n      return word.charAt(0).toUpperCase() + word.slice(1);\n    })\n    .join(\" \");\n}\n\n/**\n * Format payment terms for display\n */\nexport function formatPaymentTerms(terms: string): string {\n  const termsMap: Record<string, string> = {\n    NET30: \"Net 30 days\",\n    NET60: \"Net 60 days\",\n    NET90: \"Net 90 days\",\n    DUE_ON_RECEIPT: \"Due on receipt\",\n    COD: \"Cash on delivery\",\n    PREPAID: \"Prepaid\",\n    \"2/10_NET30\": \"2% 10, Net 30\",\n  };\n\n  return termsMap[terms] ?? terms;\n}\n"],"mappings":"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","names":["daysBetween","import_react","import_react","import_react","formatCurrency","import_react","import_zod","import_zod","import_zod","daysBetween","formatter"]}